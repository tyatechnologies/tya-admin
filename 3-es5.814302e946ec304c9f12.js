!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+C6U":function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return D})),n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return k}));var i=n("fXoL"),r=n("ofXK"),a=["move","copy","link"];function l(e){return"application/x-dnd"===e.substr(0,"application/x-dnd".length)}function o(e){if(e.dataTransfer){var t=e.dataTransfer.types;if(!t)return"Text";for(var n=0;n<t.length;n++)if("Text"===t[n]||"application/json"===t[n]||l(t[n]))return t[n]}return null}function s(e,t){return"all"===t||"uninitialized"===t?e:e.filter((function(e){return-1!==t.toLowerCase().indexOf(e)}))}function u(e,t){var n=window.getComputedStyle(t),i=parseFloat(n.paddingTop)||0,r=parseFloat(n.paddingLeft)||0,a=parseFloat(n.borderTopWidth)||0,l=parseFloat(n.borderLeftWidth)||0;return{x:e.offsetX+r+l,y:e.offsetY+i+a}}var f={isDragging:!1,dropEffect:"none",effectAllowed:"all",type:void 0};function h(){f.isDragging=!1,f.dropEffect=void 0,f.effectAllowed=void 0,f.type=void 0}function p(e,t){!0===f.isDragging&&(f.dropEffect=t),e.dataTransfer.dropEffect=t}function g(e,t){var n=s(a,e.dataTransfer?e.dataTransfer.effectAllowed:"uninitialized");return!0===f.isDragging&&(n=s(n,f.effectAllowed)),t&&(n=s(n,t)),0===n.length?"none":e.ctrlKey&&-1!==n.indexOf("copy")?"copy":e.altKey&&-1!==n.indexOf("link")?"link":n[0]}function m(e){if(!0===f.isDragging)return f.type;var t=o(e);return null!==t&&"Text"!==t&&"application/json"!==t&&t.substr("application/x-dnd".length+1)||void 0}function v(){return!1===f.isDragging}var b=f,y=function(){var e=function(){function e(t,n,r){var a=this;c(this,e),this.elementRef=t,this.renderer=n,this.ngZone=r,this.dndEffectAllowed="copy",this.dndDraggingClass="dndDragging",this.dndDraggingSourceClass="dndDraggingSource",this.dndDraggableDisabledClass="dndDraggableDisabled",this.dndDragImageOffsetFunction=u,this.dndStart=new i.r,this.dndDrag=new i.r,this.dndEnd=new i.r,this.dndMoved=new i.r,this.dndCopied=new i.r,this.dndLinked=new i.r,this.dndCanceled=new i.r,this.draggable=!0,this.isDragStarted=!1,this.dragEventHandler=function(e){return a.onDrag(e)}}return d(e,[{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular((function(){e.elementRef.nativeElement.addEventListener("drag",e.dragEventHandler)}))}},{key:"ngOnDestroy",value:function(){this.elementRef.nativeElement.removeEventListener("drag",this.dragEventHandler),!0===this.isDragStarted&&h()}},{key:"onDragStart",value:function(e){var t=this;if(!1===this.draggable)return!1;if(void 0!==this.dndHandle&&void 0===e._dndUsingHandle)return!1;!function(e,t,n){f.isDragging=!0,f.dropEffect="none",f.effectAllowed=t,f.type=n,e.dataTransfer.effectAllowed=t}(e,this.dndEffectAllowed,this.dndType),this.isDragStarted=!0,function(e,t,n){var i="application/x-dnd"+(t.type?"-"+t.type:""),r=JSON.stringify(t);try{e.dataTransfer.setData(i,r)}catch(c){try{e.dataTransfer.setData("application/json",r)}catch(c){var l=s(a,n);e.dataTransfer.effectAllowed=l[0],e.dataTransfer.setData("Text",r)}}}(e,{data:this.dndDraggable,type:this.dndType},b.effectAllowed),this.dragImage=this.determineDragImage(),this.renderer.addClass(this.dragImage,this.dndDraggingClass),void 0===this.dndDragImageElementRef&&void 0===e._dndUsingHandle||function(e,t,n){var i=n(e,t)||{x:0,y:0};e.dataTransfer.setDragImage(t,i.x,i.y)}(e,this.dragImage,this.dndDragImageOffsetFunction);var n=this.renderer.listen(this.elementRef.nativeElement,"drag",(function(){t.renderer.addClass(t.elementRef.nativeElement,t.dndDraggingSourceClass),n()}));this.dndStart.emit(e),e.stopPropagation()}},{key:"onDrag",value:function(e){this.dndDrag.emit(e)}},{key:"onDragEnd",value:function(e){var t,n=this;switch(b.dropEffect){case"copy":t=this.dndCopied;break;case"link":t=this.dndLinked;break;case"move":t=this.dndMoved;break;default:t=this.dndCanceled}t.emit(e),this.dndEnd.emit(e),h(),this.isDragStarted=!1,this.renderer.removeClass(this.dragImage,this.dndDraggingClass),window.setTimeout((function(){n.renderer.removeClass(n.elementRef.nativeElement,n.dndDraggingSourceClass)}),0),e.stopPropagation()}},{key:"registerDragHandle",value:function(e){this.dndHandle=e}},{key:"registerDragImage",value:function(e){this.dndDragImageElementRef=e}},{key:"determineDragImage",value:function(){return void 0!==this.dndDragImageElementRef?this.dndDragImageElementRef.nativeElement:this.elementRef.nativeElement}},{key:"dndDisableIf",set:function(e){this.draggable=!e,this.draggable?this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass):this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass)}},{key:"dndDisableDragIf",set:function(e){this.dndDisableIf=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Xb(i.o),i.Xb(i.N),i.Xb(i.H))},e.\u0275dir=i.Sb({type:e,selectors:[["","dndDraggable",""]],hostVars:1,hostBindings:function(e,t){1&e&&i.kc("dragstart",(function(e){return t.onDragStart(e)}))("dragend",(function(e){return t.onDragEnd(e)})),2&e&&i.Mb("draggable",t.draggable)},inputs:{dndEffectAllowed:"dndEffectAllowed",dndDraggingClass:"dndDraggingClass",dndDraggingSourceClass:"dndDraggingSourceClass",dndDraggableDisabledClass:"dndDraggableDisabledClass",dndDragImageOffsetFunction:"dndDragImageOffsetFunction",dndDisableIf:"dndDisableIf",dndDisableDragIf:"dndDisableDragIf",dndDraggable:"dndDraggable",dndType:"dndType"},outputs:{dndStart:"dndStart",dndDrag:"dndDrag",dndEnd:"dndEnd",dndMoved:"dndMoved",dndCopied:"dndCopied",dndLinked:"dndLinked",dndCanceled:"dndCanceled"}}),e}(),D=function(){var e=function e(t){c(this,e),this.elementRef=t};return e.\u0275fac=function(t){return new(t||e)(i.Xb(i.o))},e.\u0275dir=i.Sb({type:e,selectors:[["","dndPlaceholderRef",""]]}),e}(),E=function(){var e=function(){function e(t,n,r){var a=this;c(this,e),this.ngZone=t,this.elementRef=n,this.renderer=r,this.dndAllowExternal=!1,this.dndHorizontal=!1,this.dndDragoverClass="dndDragover",this.dndDropzoneDisabledClass="dndDropzoneDisabled",this.dndDragover=new i.r,this.dndDrop=new i.r,this.placeholder=null,this.disabled=!1,this.dragEnterEventHandler=function(e){return a.onDragEnter(e)},this.dragOverEventHandler=function(e){return a.onDragOver(e)},this.dragLeaveEventHandler=function(e){return a.onDragLeave(e)}}return d(e,[{key:"ngAfterViewInit",value:function(){var e=this;this.placeholder=this.tryGetPlaceholder(),this.removePlaceholderFromDOM(),this.ngZone.runOutsideAngular((function(){e.elementRef.nativeElement.addEventListener("dragenter",e.dragEnterEventHandler),e.elementRef.nativeElement.addEventListener("dragover",e.dragOverEventHandler),e.elementRef.nativeElement.addEventListener("dragleave",e.dragLeaveEventHandler)}))}},{key:"ngOnDestroy",value:function(){this.elementRef.nativeElement.removeEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.removeEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.removeEventListener("dragleave",this.dragLeaveEventHandler)}},{key:"onDragEnter",value:function(e){if(!0!==e._dndDropzoneActive){if(void 0===e._dndDropzoneActive){var t=document.elementFromPoint(e.clientX,e.clientY);this.elementRef.nativeElement.contains(t)&&(e._dndDropzoneActive=!0)}var n=m(e);!1!==this.isDropAllowed(n)&&e.preventDefault()}else this.cleanupDragoverState()}},{key:"onDragOver",value:function(e){if(!e.defaultPrevented){var t=m(e);if(!1!==this.isDropAllowed(t)){this.checkAndUpdatePlaceholderPosition(e);var n=g(e,this.dndEffectAllowed);"none"!==n?(e.preventDefault(),p(e,n),this.dndDragover.emit(e),this.renderer.addClass(this.elementRef.nativeElement,this.dndDragoverClass)):this.cleanupDragoverState()}}}},{key:"onDrop",value:function(e){try{var t=m(e);if(!1===this.isDropAllowed(t))return;var n=function(e,t){var n=o(e);return!0===t?null!==n&&l(n)?JSON.parse(e.dataTransfer.getData(n)):{}:JSON.parse(e.dataTransfer.getData(n))}(e,v());if(!1===this.isDropAllowed(n.type))return;e.preventDefault();var i=g(e);if(p(e,i),"none"===i)return;var r=this.getPlaceholderIndex();if(-1===r)return;this.dndDrop.emit({event:e,dropEffect:i,isExternal:v(),data:n.data,index:r,type:t}),e.stopPropagation()}finally{this.cleanupDragoverState()}}},{key:"onDragLeave",value:function(e){if(void 0===e._dndDropzoneActive){var t=document.elementFromPoint(e.clientX,e.clientY);if(this.elementRef.nativeElement.contains(t))return void(e._dndDropzoneActive=!0)}this.cleanupDragoverState(),p(e,"none")}},{key:"isDropAllowed",value:function(e){if(!0===this.disabled)return!1;if(!0===v()&&!1===this.dndAllowExternal)return!1;if(!this.dndDropzone)return!0;if(!e)return!0;if(!1===Array.isArray(this.dndDropzone))throw new Error("dndDropzone: bound value to [dndDropzone] must be an array!");return-1!==this.dndDropzone.indexOf(e)}},{key:"tryGetPlaceholder",value:function(){return void 0!==this.dndPlaceholderRef?this.dndPlaceholderRef.elementRef.nativeElement:this.elementRef.nativeElement.querySelector("[dndPlaceholderRef]")}},{key:"removePlaceholderFromDOM",value:function(){null!==this.placeholder&&null!==this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}},{key:"checkAndUpdatePlaceholderPosition",value:function(e){if(null!==this.placeholder){this.placeholder.parentNode!==this.elementRef.nativeElement&&this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder);var t=function(e,t){for(var n=t;n.parentNode!==e;){if(!n.parentNode)return null;n=n.parentNode}return n}(this.elementRef.nativeElement,e.target);null!==t&&t!==this.placeholder&&(function(e,t,n){var i=t.getBoundingClientRect();return n?e.clientX<i.left+i.width/2:e.clientY<i.top+i.height/2}(e,t,this.dndHorizontal)?t.previousSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,t):t.nextSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,t.nextSibling))}}},{key:"getPlaceholderIndex",value:function(){if(null!==this.placeholder)return Array.prototype.indexOf.call(this.elementRef.nativeElement.children,this.placeholder)}},{key:"cleanupDragoverState",value:function(){this.renderer.removeClass(this.elementRef.nativeElement,this.dndDragoverClass),this.removePlaceholderFromDOM()}},{key:"dndDisableIf",set:function(e){this.disabled=!!e,this.disabled?this.renderer.addClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass):this.renderer.removeClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass)}},{key:"dndDisableDropIf",set:function(e){this.dndDisableIf=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Xb(i.H),i.Xb(i.o),i.Xb(i.N))},e.\u0275dir=i.Sb({type:e,selectors:[["","dndDropzone",""]],contentQueries:function(e,t,n){var r;1&e&&i.Qb(n,D,!0),2&e&&i.zc(r=i.lc())&&(t.dndPlaceholderRef=r.first)},hostBindings:function(e,t){1&e&&i.kc("drop",(function(e){return t.onDrop(e)}))},inputs:{dndAllowExternal:"dndAllowExternal",dndHorizontal:"dndHorizontal",dndDragoverClass:"dndDragoverClass",dndDropzoneDisabledClass:"dndDropzoneDisabledClass",dndDisableIf:"dndDisableIf",dndDisableDropIf:"dndDisableDropIf",dndDropzone:"dndDropzone",dndEffectAllowed:"dndEffectAllowed"},outputs:{dndDragover:"dndDragover",dndDrop:"dndDrop"}}),e}(),k=function(){var e=function e(){c(this,e)};return e.\u0275mod=i.Vb({type:e}),e.\u0275inj=i.Ub({factory:function(t){return new(t||e)},imports:[[r.c]]}),e}()},"5CSc":function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("ExIg"),r=n("bANk"),a=n("cp0P"),l=n("dihp"),o=n("nYR2"),s=n("CjdU"),u=n("fXoL"),f=n("aceb"),h=n("wnGv"),p=n("ofXK"),g=n("3Pt+"),m=["table"];function v(e,t){if(1&e){var n=u.ec();u.dc(0,"div"),u.dc(1,"nb-card",23),u.dc(2,"nb-card-header"),u.Oc(3,"Ch\u1ec9nh s\u1eeda"),u.cc(),u.dc(4,"nb-card-body"),u.dc(5,"div",24),u.dc(6,"nb-checkbox",25),u.kc("ngModelChange",(function(e){return u.Dc(n),u.mc().mulEditEntity.isView=e})),u.Oc(7,"\u0110\u01b0\u1ee3c ph\xe9p xem"),u.cc(),u.dc(8,"nb-checkbox",25),u.kc("ngModelChange",(function(e){return u.Dc(n),u.mc().mulEditEntity.isCreate=e})),u.Oc(9,"\u0110\u01b0\u1ee3c ph\xe9p t\u1ea1o"),u.cc(),u.dc(10,"nb-checkbox",25),u.kc("ngModelChange",(function(e){return u.Dc(n),u.mc().mulEditEntity.isEdit=e})),u.Oc(11,"\u0110\u01b0\u1ee3c ph\xe9p ch\u1ec9nh s\u1eeda"),u.cc(),u.dc(12,"nb-checkbox",25),u.kc("ngModelChange",(function(e){return u.Dc(n),u.mc().mulEditEntity.isDelete=e})),u.Oc(13,"\u0110\u01b0\u1ee3c ph\xe9p x\xf3a"),u.cc(),u.cc(),u.dc(14,"div",24),u.dc(15,"input",26),u.kc("ngModelChange",(function(e){return u.Dc(n),u.mc().mulEditEntity.definition=e})),u.cc(),u.cc(),u.cc(),u.dc(16,"nb-card-footer",27),u.dc(17,"button",28),u.kc("click",(function(){return u.Dc(n),u.mc().cancelMulEdit()})),u.Oc(18,"H\u1ee7y"),u.cc(),u.dc(19,"button",29),u.kc("click",(function(){return u.Dc(n),u.mc().mulEditSubmit()})),u.Oc(20,"L\u01b0u"),u.cc(),u.cc(),u.cc(),u.cc()}if(2&e){var i=u.mc();u.Lb(6),u.sc("ngModel",i.mulEditEntity.isView),u.Lb(2),u.sc("ngModel",i.mulEditEntity.isCreate),u.Lb(2),u.sc("ngModel",i.mulEditEntity.isEdit),u.Lb(2),u.sc("ngModel",i.mulEditEntity.isDelete),u.Lb(3),u.sc("ngModel",i.mulEditEntity.definition)}}function b(e,t){if(1&e){var n=u.ec();u.dc(0,"input",30),u.kc("ngModelChange",(function(e){return u.Dc(n),t.row[t.column.prop]=e}))("change",(function(){u.Dc(n);var e=t.column,i=t.row;return u.mc().updateCellValue(e.prop,i)})),u.cc()}2&e&&u.sc("ngModel",t.row[t.column.prop])}function y(e,t){if(1&e){var n=u.ec();u.dc(0,"input",30),u.kc("ngModelChange",(function(e){return u.Dc(n),t.row[t.column.prop]=e}))("change",(function(){u.Dc(n);var e=t.column,i=t.row;return u.mc().updateCellValue(e.prop,i)})),u.cc()}2&e&&u.sc("ngModel",t.row[t.column.prop])}function D(e,t){if(1&e){var n=u.ec();u.dc(0,"input",30),u.kc("ngModelChange",(function(e){return u.Dc(n),t.row[t.column.prop]=e}))("change",(function(){u.Dc(n);var e=t.column,i=t.row;return u.mc().updateCellValue(e.prop,i)})),u.cc()}2&e&&u.sc("ngModel",t.row[t.column.prop])}function E(e,t){if(1&e){var n=u.ec();u.dc(0,"input",30),u.kc("ngModelChange",(function(e){return u.Dc(n),t.row[t.column.prop]=e}))("change",(function(){u.Dc(n);var e=t.column,i=t.row;return u.mc().updateCellValue(e.prop,i)})),u.cc()}2&e&&u.sc("ngModel",t.row[t.column.prop])}function k(e,t){if(1&e){var n=u.ec();u.dc(0,"nb-checkbox",31),u.kc("ngModelChange",(function(e){return u.Dc(n),t.row[t.column.prop]=e}))("ngModelChange",(function(){u.Dc(n);var e=t.column,i=t.row;return u.mc().updateCellValue(e.prop,i)})),u.cc()}2&e&&u.sc("ngModel",t.row[t.column.prop])}var w=function(){var e=function(){function e(t,n,r,a,l){c(this,e),this.layerService=t,this.datasetService=n,this.roleLayerService=r,this.toast=a,this.roleService=l,this.ColumnMode=i.a,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1,hasScroll:!0},this.lstDatasetId=[],this.configSelDts={service:this.datasetService,fieldName:"datasetName",fieldValue:"datasetId"},this.bulks=[{name:"edit",title:"Ch\u1ec9nh s\u1eeda"}],this.isSync=!1,this.tblItemSelected=[],this.mulEditEntity=null,this.isMulEditingReq=!1}return d(e,[{key:"ngOnInit",value:function(){this.datatableService={service:this.roleLayerService,primaryField:"id",builder:this.getBuilder.bind(this)}}},{key:"getBuilder",value:function(e){e.select(["roleId","isView","isCreate","isDelete","isEdit","definition","outFields","queryFields","updateFields"]),e.setJoin([{field:"layer",select:["layerName","datasetId"]}]),e.setFilter([{field:"roleId",operator:"$eq",value:this.roleId},{field:"layer.datasetId",operator:"$in",value:this.lstDatasetId}])}},{key:"selectedItem",value:function(e){this.tblItemSelected=e.selected}},{key:"bulkClick",value:function(e){"delete"===e.action.name||"edit"===e.action.name&&(this.mulEditEntity={isEdit:!0,isCreate:!0,isDelete:!0,isView:!0,outFields:null,queryFields:null,updateFields:null})}},{key:"mulEditSubmit",value:function(){var e=this;this.tblItemSelected&&this.mulEditEntity&&(this.isMulEditingReq=!0,this.subcriberMulEdit=Object(a.a)(this.tblItemSelected.map((function(t){return e.roleLayerService.patch(t.id,e.mulEditEntity)}))).pipe(Object(o.a)((function(){e.isMulEditingReq=!1,delete e.subcriberMulEdit,delete e.mulEditEntity}))).subscribe((function(t){e.toast.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng"),e.table.loadData()}),(function(t){e.toast.danger(t&&t.message,"L\u1ed7i")})))}},{key:"cancelMulEdit",value:function(){this.subcriberMulEdit&&this.subcriberMulEdit.unsubscribe(),delete this.subcriberMulEdit,this.mulEditEntity=null,this.isMulEditingReq=!1}},{key:"sync",value:function(){var e=this;this.roleId&&(this.lstDatasetId?(this.isSync=!0,this.roleService.syncLayers({roleId:this.roleId,lstDatasetId:this.lstDatasetId}).pipe(Object(o.a)((function(){return e.isSync=!1}))).subscribe((function(t){e.toast.success("\u0110\u1ed3ng b\u1ed9 th\xe0nh c\xf4ng "+t.length,"Th\xe0nh c\xf4ng"),e.table.loadData()}),(function(t){return e.toast.danger(t||"C\xf3 l\u1ed7i x\u1ea3y ra")}))):this.toast.warning("Vui l\xf2ng ch\u1ecdn dataset","Th\xf4ng b\xe1o"))}},{key:"updateCellValue",value:function(e,t){var n,i,r;this.roleLayerService.patch(t.id,(n={},i=e,r=t[e],i in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,n)).subscribe()}},{key:"isMulEdit",get:function(){return Boolean(this.mulEditEntity)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u.Xb(r.a),u.Xb(s.a),u.Xb(l.a),u.Xb(f.qb),u.Xb(l.b))},e.\u0275cmp=u.Rb({type:e,selectors:[["ga-layer"]],viewQuery:function(e,t){var n;1&e&&u.Sc(m,!0),2&e&&u.zc(n=u.lc())&&(t.table=n.first)},inputs:{roleId:"roleId"},decls:33,vars:25,consts:[[1,"row"],[1,"col-md-12"],["fullWidth","","placeholder","Dataset",1,"w-100",3,"multiple","config","value","valueChange"],["selectDts",""],[1,"col-md-12","d-flex","justify-content-end","mt-2"],["nbButton","","size","small","outline","","ghost","","status","danger",3,"click"],["nbButton","","size","small","outline","","ghost","",3,"click"],["nbButton","","size","small","outline","",3,"click"],["nbButton","","outline","","status","danger","nbTooltip","T\u1ea3i l\u1edbp d\u1eef li\u1ec7u t\u1eeb h\u1ec7 th\u1ed1ng \u0111\u1ec3 c\u1ea5p quy\u1ec1n truy c\u1eadp",3,"disabled","nbSpinner","click"],[4,"ngIf"],["selectionType","checkbox",1,"material","striped",3,"externalPaging","limit","datatableService","columnMode","bulkActions","selected","bulkClick","select"],["table",""],["name","T\xean","prop","layer.layerName",3,"flexGrow"],["name","Xem","prop","isView",3,"flexGrow","cellTemplate"],["name","T\u1ea1o","prop","isCreate",3,"flexGrow","cellTemplate"],["name","X\xf3a","prop","isDelete",3,"flexGrow","cellTemplate"],["name","S\u1eeda","prop","isEdit",3,"flexGrow","cellTemplate"],["name","L\u1ec7nh truy v\u1ea5n","prop","definition",3,"flexGrow"],["ngn-datatable-cell-template",""],["name","Thu\u1ed9c t\xednh hi\u1ec3n th\u1ecb","prop","outFields",3,"flexGrow"],["name","Thu\u1ed9c t\xednh t\xecm ki\u1ebfm","prop","queryFields",3,"flexGrow"],["name","Thu\u1ed9c t\xednh c\u1eadp nh\u1eadt","prop","updateFields",3,"flexGrow"],["tplCellStatus",""],[1,"mt-2"],[1,"row","col-md-12"],[1,"form-input",3,"ngModel","ngModelChange"],["type","text","nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["nbButton","","size","small","ghost","",3,"click"],["nbButton","","size","small",3,"click"],["nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange"]],template:function(e,t){if(1&e){var n=u.ec();u.dc(0,"div",0),u.dc(1,"div",1),u.dc(2,"ga-select",2,3),u.kc("valueChange",(function(e){return t.lstDatasetId=e})),u.cc(),u.cc(),u.dc(4,"div",4),u.dc(5,"button",5),u.kc("click",(function(){return t.lstDatasetId=[]})),u.Oc(6,"H\u1ee7y ch\u1ecdn t\u1ea5t c\u1ea3 dataset"),u.cc(),u.dc(7,"button",6),u.kc("click",(function(){return u.Dc(n),u.Ac(3).selectAll()})),u.Oc(8,"Ch\u1ecdn t\u1ea5t c\u1ea3 dataset"),u.cc(),u.dc(9,"button",7),u.kc("click",(function(){return u.Dc(n),u.Ac(17).loadData()})),u.Oc(10,"L\u1ecdc"),u.cc(),u.cc(),u.dc(11,"div",1),u.dc(12,"div"),u.dc(13,"button",8),u.kc("click",(function(){return t.sync()})),u.Oc(14," \u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u "),u.cc(),u.cc(),u.Mc(15,v,21,5,"div",9),u.dc(16,"ngn-datatable",10,11),u.kc("bulkClick",(function(e){return t.bulkClick(e)}))("select",(function(e){return t.selectedItem(e)})),u.Yb(18,"ngn-datatable-column",12),u.Yb(19,"ngn-datatable-column",13),u.Yb(20,"ngn-datatable-column",14),u.Yb(21,"ngn-datatable-column",15),u.Yb(22,"ngn-datatable-column",16),u.dc(23,"ngn-datatable-column",17),u.Mc(24,b,1,1,"ng-template",18),u.cc(),u.dc(25,"ngn-datatable-column",19),u.Mc(26,y,1,1,"ng-template",18),u.cc(),u.dc(27,"ngn-datatable-column",20),u.Mc(28,D,1,1,"ng-template",18),u.cc(),u.dc(29,"ngn-datatable-column",21),u.Mc(30,E,1,1,"ng-template",18),u.cc(),u.cc(),u.cc(),u.cc(),u.Mc(31,k,1,1,"ng-template",null,22,u.Nc)}if(2&e){var i=u.Ac(32);u.Lb(2),u.sc("multiple",!0)("config",t.configSelDts)("value",t.lstDatasetId),u.Lb(11),u.sc("disabled",0===t.lstDatasetId.length||t.isSync)("nbSpinner",t.isSync),u.Lb(2),u.sc("ngIf",t.isMulEdit),u.Lb(1),u.sc("externalPaging",!0)("limit",255)("datatableService",t.datatableService)("columnMode",t.ColumnMode.flex)("bulkActions",t.bulks)("selected",t.tblItemSelected),u.Lb(2),u.sc("flexGrow",2),u.Lb(1),u.sc("flexGrow",1)("cellTemplate",i),u.Lb(1),u.sc("flexGrow",1)("cellTemplate",i),u.Lb(1),u.sc("flexGrow",1)("cellTemplate",i),u.Lb(1),u.sc("flexGrow",1)("cellTemplate",i),u.Lb(1),u.sc("flexGrow",2),u.Lb(2),u.sc("flexGrow",4),u.Lb(2),u.sc("flexGrow",4),u.Lb(2),u.sc("flexGrow",4)}},directives:[h.a,f.o,f.rb,f.kb,p.u,i.d,i.c,i.b,f.r,f.t,f.q,f.v,g.j,g.m,f.G,g.b,f.s],styles:[""]}),e}()},CjdU:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var a=i("AytR"),l=i("i/XZ"),o=i("Zt20"),s=i("fXoL"),u=i("tk/3"),f=function(){var e=function(e){n(i,e);var t=r(i);function i(e){return c(this,i),t.call(this,{apiUrl:a.a.apiUrl,entity:"sys/dataset"},e)}return d(i,[{key:"getGDBNotExists",value:function(){var e=o.a.create({filter:[{field:"notExist",operator:"$eq",value:!0}]});return this.http.get(this.getBaseUrl()+"/gdb",{params:this.getParamsFromQuery(e)})}},{key:"getManyGDB",value:function(){return this.http.get(this.getBaseUrl()+"/gdb")}},{key:"updateDatasetName",value:function(e,t){return this.http.post(this.getBaseUrl()+"/gdb/alias/"+e,{datasetName:t})}},{key:"updateAliasNameFromGDB",value:function(e){return this.http.patch(this.getBaseUrl()+"/aliasfromgdb",{lstDatasetId:e},{headers:{"Content-Type":"application/json"}})}}]),i}(l.a);return e.\u0275fac=function(t){return new(t||e)(s.hc(u.b))},e.\u0275prov=s.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},EaEm:function(t,n,i){"use strict";i.d(n,"a",(function(){return g}));var r=i("mrSG"),a=i("YTAs"),l=i("dihp"),o=i("fXoL"),s=i("aceb"),u=i("+C6U"),f=i("ofXK");function h(e,t){if(1&e&&(o.dc(0,"nb-list-item",5),o.dc(1,"nb-alert",6),o.Oc(2),o.cc(),o.cc()),2&e){var n=t.$implicit;o.sc("dndDraggable",n),o.Lb(1),o.sc("accent","D"===n.environmentId?"success":"W"===n.environmentId?"warning":"M"===n.environmentId?"info":"basic"),o.Lb(1),o.Qc(" ",n.applicationName,"")}}function p(e,t){if(1&e&&(o.dc(0,"nb-list-item",5),o.dc(1,"nb-alert",7),o.Oc(2),o.cc(),o.cc()),2&e){var n=t.$implicit;o.sc("dndDraggable",n),o.Lb(1),o.sc("accent","D"===n.environmentId?"success":"W"===n.environmentId?"warning":"M"===n.environmentId?"info":"basic"),o.Lb(1),o.Qc(" ",n.applicationName,"")}}var g=function(){var t=function(){function t(e,n,i){c(this,t),this.applicationService=e,this.roleService=n,this.toast=i,this.columns=[],this.isRequest=!1}return d(t,[{key:"ngOnInit",value:function(){var e=this;this.columns=[{name:"M\xe3 c\u1ed9t",prop:"applicationName"},{name:"T\xean c\u1ed9t",prop:"alias"},{name:"Nh\xf3m",prop:"applicationGroup.applicationName"},{name:"Tr\u1ea1ng th\xe1i",prop:"isEnabled"},{name:"M\xf4i tr\u01b0\u1eddng",prop:"environmentId"}],this.roleService.getOne(this.roleId,{fields:["roleName","applications"],join:[{field:"applications",select:["applicationId","applicationName","environmentId"]}]}).subscribe((function(t){e.lstDataSelected=t.applications;var n=[{field:"isEnabled",operator:"$eq",value:!0}];e.lstDataSelected.length&&n.push({field:"applicationId",operator:"$notin",value:e.lstDataSelected.map((function(e){return e.applicationId}))}),e.applicationService.getMany({fields:["applicationName","applicationGroup","isEnabled","environmentId"],filter:n}).subscribe((function(t){return e.lstDataAvailable=t}))}))}},{key:"onDrop",value:function(t,n){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r,a,l,c,o,d;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r=t.data,a=e(this.lstDataAvailable),l=e(this.lstDataSelected),c="remove"===n?this.lstDataAvailable:this.lstDataSelected,o="insert"===n?this.lstDataAvailable:this.lstDataSelected,!((d=o.findIndex((function(e){return e.applicationId===r.applicationId})))>-1)){i.next=15;break}return c.push(r),o.splice(d,1),i.prev=3,this.isRequest=!0,i.next=7,this.roleService.patch(this.roleId,{applications:this.lstDataSelected}).toPromise();case 7:i.next=12;break;case 9:i.prev=9,i.t0=i.catch(3),this.toast.danger(i.t0&&i.t0.message,"L\u1ed7i"),this.lstDataAvailable=a,this.lstDataSelected=l;case 12:return i.prev=12,this.isRequest=!1,i.finish(12);case 15:case"end":return i.stop()}}),i,this,[[3,9,12,15]])})))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Xb(a.b),o.Xb(l.b),o.Xb(s.qb))},t.\u0275cmp=o.Rb({type:t,selectors:[["ga-application"]],inputs:{roleId:"roleId"},decls:13,vars:3,consts:[[1,"row",3,"nbSpinner"],[1,"col-md-6"],["dndDropzone","",1,"dndList",3,"dndDrop"],["dndPlaceholderRef","",1,"dndPlaceholder"],[3,"dndDraggable",4,"ngFor","ngForOf"],[3,"dndDraggable"],[1,"full-width",3,"accent"],[3,"accent"]],template:function(e,t){1&e&&(o.dc(0,"div",0),o.dc(1,"div",1),o.dc(2,"nb-card-header"),o.Oc(3,"\u1ee8ng d\u1ee5ng ch\u01b0a ch\u1ecdn"),o.cc(),o.dc(4,"nb-list",2),o.kc("dndDrop",(function(e){return t.onDrop(e,"remove")})),o.Yb(5,"nb-list-item",3),o.Mc(6,h,3,3,"nb-list-item",4),o.cc(),o.cc(),o.dc(7,"div",1),o.dc(8,"nb-card-header"),o.Oc(9,"\u1ee8ng d\u1ee5ng \u0111\xe3 ch\u1ecdn"),o.cc(),o.dc(10,"nb-list",2),o.kc("dndDrop",(function(e){return t.onDrop(e,"insert")})),o.Yb(11,"nb-list-item",3),o.Mc(12,p,3,3,"nb-list-item",4),o.cc(),o.cc(),o.cc()),2&e&&(o.sc("nbSpinner",t.isRequest),o.Lb(6),o.sc("ngForOf",t.lstDataAvailable),o.Lb(6),o.sc("ngForOf",t.lstDataSelected))},directives:[s.kb,s.t,s.P,u.b,s.Q,u.d,f.t,u.a,s.j],styles:["nb-list[_ngcontent-%COMP%]{height:100%}.dndList[_ngcontent-%COMP%]{transition:all .3s ease}.dndList.dndDragover[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:12px}.dndDragging[_ngcontent-%COMP%]{border:1px solid green}.dndPlaceholder[_ngcontent-%COMP%]{min-height:72px;border:1px dashed green;background-color:rgba(0,0,0,.1)}nb-alert[_ngcontent-%COMP%]{margin:0;padding:6px 12px}"]}),t}()},bANk:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var a=i("AytR"),l=i("WJ/N"),o=i("fXoL"),s=i("tk/3"),u=function(){var e=function(e){n(i,e);var t=r(i);function i(e){return c(this,i),t.call(this,{apiUrl:a.a.apiUrl,entity:"sys/layer"},e)}return d(i,[{key:"getManyGDB",value:function(e){return this.http.get(this.getBaseUrl()+"/gdb",{params:this.getParamsFromQuery(e)})}},{key:"getOneGDB",value:function(e){return this.http.get(this.getBaseUrl()+"/gdb/"+e)}},{key:"updateDatasetName",value:function(e,t){return this.http.post(this.getBaseUrl()+"/gdb/alias/"+e,{layerName:t})}},{key:"getFields",value:function(e){return this.http.get(this.getBaseUrl()+"/gdb/".concat(e,"/field"))}},{key:"updateField",value:function(e,t,n){return this.http.post(this.getBaseUrl()+"/gdb/".concat(e,"/field/").concat(t),n)}},{key:"updateAliasNameFromGDB",value:function(e){return this.http.patch(this.getBaseUrl()+"/aliasfromgdb",{lstLayerId:e},{headers:{"Content-Type":"application/json"}})}},{key:"getColumnType",value:function(){return this.http.get(this.getBaseUrl()+"/columndatatype")}},{key:"getColumns",value:function(e){return this.http.get("".concat(this.getBaseUrl(),"/column/").concat(e.table))}},{key:"hasTable",value:function(e){return this.http.get("".concat(this.getBaseUrl(),"/hastable/").concat(e.table))}},{key:"createTable",value:function(e){return this.http.post(this.getBaseUrl()+"/createtable",JSON.stringify(e.table),{headers:{"content-type":"application/json"}})}},{key:"addColumn",value:function(e){return this.http.post("".concat(this.getBaseUrl(),"/addcolumn/").concat(e.tableName),JSON.stringify(e.column),{headers:{"content-type":"application/json"}})}},{key:"dropColumn",value:function(e){return this.http.delete("".concat(this.getBaseUrl(),"/dropColumn/").concat(e.tableName,"/").concat(e.columnName))}},{key:"syncColumn",value:function(e){return this.http.patch("".concat(this.getBaseUrl(),"/synccolumn/").concat(e.tableName),JSON.stringify(e.columns),{headers:{"content-type":"application/json"}})}},{key:"updateDisplayColumn",value:function(e){return this.http.patch("".concat(this.getBaseUrl(),"/columnDisplay/").concat(e.tableName),JSON.stringify({columnDisplay:e.columnDisplay}),{headers:{"content-type":"application/json"}})}},{key:"changeGeometryType",value:function(e){return this.http.patch("".concat(this.getBaseUrl(),"/geometrytype/").concat(e.tableName),JSON.stringify({geometryType:e.geometryType}),{headers:{"content-type":"application/json"}})}}]),i}(l.a);return e.\u0275fac=function(t){return new(t||e)(o.hc(s.b))},e.\u0275prov=o.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},ronx:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("ofXK"),r=n("1ua0"),a=n("aceb"),l=n("+C6U"),o=n("fXoL"),d=function(){var e=function e(){c(this,e)};return e.\u0275mod=o.Vb({type:e}),e.\u0275inj=o.Ub({factory:function(t){return new(t||e)},imports:[[i.c,r.a,a.u,a.p,a.R,a.lb,a.k,l.c]]}),e}()},tvm6:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("ofXK"),r=n("1ua0"),a=n("aceb"),l=n("BDdu"),o=n("3Pt+"),d=n("DS98"),s=n("ExIg"),u=n("fXoL"),f=function(){var e=function e(){c(this,e)};return e.\u0275mod=u.Vb({type:e}),e.\u0275inj=u.Ub({factory:function(t){return new(t||e)},imports:[[i.c,r.a,a.k,l.a,a.w,o.g,d.a,a.H,a.p,a.sb,a.lb,a.u,s.e]]}),e}()}}])}();
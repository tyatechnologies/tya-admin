!function(){function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=c(e);if(t){var i=c(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return n(this,a)}}function n(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"45ZY":function(e,t,n){"use strict";n.r(t),n.d(t,"LayerGdbModule",(function(){return A}));var c,r=n("ofXK"),o=n("mrSG"),l=n("bANk"),u=n("4k3B"),s=n("CjdU"),d=n("Vvdx"),f=n("fXoL"),p=n("tyNb"),m=n("aceb"),h=n("wnGv"),y=n("ExIg"),b=n("3Pt+"),g=((c=function(){function e(){a(this,e)}return i(e,[{key:"transform",value:function(e,t){return e.filter((function(e){return e.type===t}))}}]),e}()).\u0275fac=function(e){return new(e||c)},c.\u0275pipe=f.Wb({name:"domainType",type:c,pure:!0}),c),v=["tplCellFieldAlias"],w=["tplCellFieldDomain"],C=["tplCellFieldType"];function I(e,t){1&e&&(f.dc(0,"nb-alert",11),f.Oc(1," Ch\u1ecdn dataset \u0111\u1ec3 xem l\u1edbp d\u1eef li\u1ec7u "),f.cc())}var D=function(){return[]},F=function(e){return{lyr:e}};function S(e,t){if(1&e){var n=f.ec();f.dc(0,"nb-list-item"),f.dc(1,"div",0),f.dc(2,"div",12),f.Oc(3),f.cc(),f.dc(4,"div",13),f.Oc(5," M\xf4 t\u1ea3: "),f.dc(6,"input",14),f.kc("ngModelChange",(function(e){return f.Dc(n),t.$implicit.layerName=e}))("change",(function(){f.Dc(n);var e=t.$implicit;return f.mc().changeLayerName(e)})),f.cc(),f.cc(),f.dc(7,"a",15),f.Oc(8,"Xem thu\u1ed9c t\xednh"),f.cc(),f.cc(),f.cc()}if(2&e){var c=t.$implicit;f.Lb(3),f.Qc("T\xean: ",c.layerId,""),f.Lb(3),f.sc("ngModel",c.layerName),f.Lb(1),f.sc("routerLink",f.uc(4,D))("queryParams",f.vc(5,F,c.layerId))}}function O(e,t){}function k(e,t){if(1&e){var n=f.ec();f.dc(0,"input",14),f.kc("ngModelChange",(function(e){return f.Dc(n),t.row.alias=e}))("change",(function(){f.Dc(n);var e=t.row;return f.mc().changeFieldAlias(e)})),f.cc()}2&e&&f.sc("ngModel",t.row.alias)}function M(e,t){if(1&e&&(f.dc(0,"nb-option",22),f.Oc(1),f.cc()),2&e){var n=t.$implicit;f.sc("value",n.id),f.Lb(1),f.Qc(" ",n.name||n.id," ")}}function T(e,t){if(1&e&&(f.dc(0,"a",23),f.Yb(1,"nb-icon",24),f.cc()),2&e){var n=f.mc(2).row;f.sc("href","/pages/layer/gdb/domain?fname="+n.domainId,f.Fc)}}function L(e,t){if(1&e){var n=f.ec();f.bc(0),f.dc(1,"div",18),f.dc(2,"nb-select",19),f.kc("selectedChange",(function(e){return f.Dc(n),f.mc().row.domainId=e}))("selectedChange",(function(){f.Dc(n);var e=f.mc().row;return f.mc().changeFieldDomain(e)})),f.dc(3,"nb-option"),f.dc(4,"em"),f.Oc(5,"None"),f.cc(),f.cc(),f.Mc(6,M,2,2,"nb-option",20),f.nc(7,"domainType"),f.cc(),f.Mc(8,T,2,1,"a",21),f.cc(),f.ac()}if(2&e){var c=f.mc().row,a=f.mc();f.Lb(2),f.sc("selected",c.domainId),f.Lb(4),f.sc("ngForOf",f.pc(7,3,a.lstDomain,c.type)),f.Lb(2),f.sc("ngIf",null==c?null:c.domainId)}}function N(e,t){1&e&&f.Oc(0," Kh\xf4ng h\u1ed7 tr\u1ee3 ")}function P(e,t){if(1&e&&(f.Mc(0,L,9,6,"ng-container",16),f.Mc(1,N,1,0,"ng-template",null,17,f.Nc)),2&e){var n=t.row,c=f.Ac(2),a=f.mc();f.sc("ngIf",n.type===a.ColumnTypeEnum.string||n.type===a.ColumnTypeEnum.integer||n.type===a.ColumnTypeEnum.smallInteger)("ngIfElse",c)}}function j(e,t){1&e&&f.Oc(0),2&e&&f.Qc(" ",t.value.replace("esriFieldType",""),"\n")}var R,x,X,_=((R=function(){function e(t,n,c,r,i,o){a(this,e),this.layerService=t,this.datasetService=n,this.router=c,this.route=r,this.codedDomainService=i,this.toast=o,this.ColumnTypeEnum=u.a,this.rows=[],this.fieldColumns=[],this.fieldRows=[],this.lstDataset=[],this.datasetConfig={fieldName:"datasetName",fieldValue:"datasetId"},this.lstDomain=[]}return i(e,[{key:"ngOnInit",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.codedDomainService.getMany().toPromise();case 2:return this.lstDomain=e.sent,e.next=5,this.datasetService.getManyGDB().toPromise();case 5:this.lstDataset=e.sent,this.fieldColumns=[{name:"T\xean",prop:"name"},{name:"M\xf4 t\u1ea3",prop:"alias",cellTemplate:this.tplCellFieldAlias,width:200},{name:"Ki\u1ec3u d\u1eef li\u1ec7u",prop:"type",cellTemplate:this.tplCellFieldType},{name:"Domain",prop:"domainId",cellTemplate:this.tplCellFieldDomain}],this.route.queryParamMap.subscribe((function(e){var n=e.get("dts");n&&n!==t._datasetIdSelected&&(t._datasetIdSelected=n,t.rows=[],n&&t.layerService.getManyGDB({filter:[{field:"datasetId",operator:"$eq",value:n}]}).subscribe((function(e){return t.rows=e})));var c=e.get("lyr");c&&t.layerService.getFields(c).subscribe((function(e){t.layerIdSelected=c,t.fieldRows=e}))}));case 8:case"end":return e.stop()}}),e,this)})))}},{key:"changeLayerName",value:function(e){this.layerService.updateDatasetName(e.layerId,e.layerName).subscribe()}},{key:"changeFieldAlias",value:function(e){var t=this;this.layerIdSelected&&this.layerService.updateField(this.layerIdSelected,e.name,{alias:e.alias}).subscribe((function(){return t.toast.success("C\u1eadp nh\u1eadt alias th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng")}),(function(e){return t.toast.danger(e||"C\xf3 l\u1ed7i x\u1ea3y ra","L\u1ed7i")}))}},{key:"changeFieldDomain",value:function(e){var t=this;this.layerIdSelected&&this.layerService.updateField(this.layerIdSelected,e.name,{domainId:e.domainId}).subscribe((function(){return t.toast.success("C\u1eadp nh\u1eadt domain th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng")}),(function(e){return t.toast.danger(e||"C\xf3 l\u1ed7i x\u1ea3y ra","L\u1ed7i")}))}},{key:"datasetIdSelected",get:function(){return this._datasetIdSelected},set:function(e){this.router.navigate([],{relativeTo:this.route,queryParams:{dts:e},queryParamsHandling:"merge"})}}]),e}()).\u0275fac=function(e){return new(e||R)(f.Xb(l.a),f.Xb(s.a),f.Xb(p.c),f.Xb(p.a),f.Xb(d.a),f.Xb(m.qb))},R.\u0275cmp=f.Rb({type:R,selectors:[["ga-layer-gdb"]],viewQuery:function(e,t){var n;1&e&&(f.Jc(v,!0),f.Jc(w,!0),f.Jc(C,!0)),2&e&&(f.zc(n=f.lc())&&(t.tplCellFieldAlias=n.first),f.zc(n=f.lc())&&(t.tplCellFieldDomain=n.first),f.zc(n=f.lc())&&(t.tplCellFieldType=n.first))},decls:22,vars:8,consts:[[1,"row"],[1,"col-md-4"],["fullWidth","","placeholder","Ch\u1ecdn dataset",3,"value","lstValue","config","valueChange"],["class","mt-2","status","warning",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-md-8"],[1,"material","striped","mt-2",3,"columns","rows","scrollbarH"],["tplCellName",""],["tplCellFieldAlias",""],["tplCellFieldDomain",""],["tplCellFieldType",""],["status","warning",1,"mt-2"],[1,"col-md-12"],[1,"mb-2","col-md-12"],["nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange","change"],["queryParamsHandling","merge",1,"col-md-12",3,"routerLink","queryParams"],[4,"ngIf","ngIfElse"],["noDomain",""],[1,"d-flex"],["placeholder","Ch\u1ecdn domain",1,"flex-grow-1",3,"selected","selectedChange"],[3,"value",4,"ngFor","ngForOf"],["class","p-2","nbTooltip","Xem chi ti\u1ebft domain","target","_blank",3,"href",4,"ngIf"],[3,"value"],["nbTooltip","Xem chi ti\u1ebft domain","target","_blank",1,"p-2",3,"href"],["icon","eye-outline"]],template:function(e,t){1&e&&(f.dc(0,"div",0),f.dc(1,"nb-card",1),f.dc(2,"nb-card-header"),f.Oc(3,"L\u1edbp d\u1eef li\u1ec7u"),f.cc(),f.dc(4,"nb-card-body"),f.dc(5,"ga-select",2),f.kc("valueChange",(function(e){return t.datasetIdSelected=e})),f.cc(),f.Mc(6,I,2,0,"nb-alert",3),f.dc(7,"nb-list"),f.Mc(8,S,9,7,"nb-list-item",4),f.cc(),f.cc(),f.cc(),f.dc(9,"nb-card",5),f.dc(10,"nb-card-header"),f.Oc(11," Thu\u1ed9c t\xednh "),f.cc(),f.dc(12,"nb-card-body"),f.Yb(13,"ngn-datatable",6),f.cc(),f.cc(),f.cc(),f.Mc(14,O,0,0,"ng-template",null,7,f.Nc),f.Mc(16,k,1,1,"ng-template",null,8,f.Nc),f.Mc(18,P,3,2,"ng-template",null,9,f.Nc),f.Mc(20,j,1,1,"ng-template",null,10,f.Nc)),2&e&&(f.Lb(5),f.sc("value",t.datasetIdSelected)("lstValue",t.lstDataset)("config",t.datasetConfig),f.Lb(1),f.sc("ngIf",!t.datasetIdSelected),f.Lb(2),f.sc("ngForOf",t.rows),f.Lb(5),f.sc("columns",t.fieldColumns)("rows",t.fieldRows)("scrollbarH",!0))},directives:[m.r,m.t,m.q,h.a,r.u,m.P,r.t,y.d,m.j,m.Q,m.G,b.b,b.j,b.m,p.f,m.fb,m.W,m.rb,m.D],pipes:[g],styles:[""]}),R),E=n("1ua0"),V=n("DS98"),q=((X=function e(){a(this,e)}).\u0275mod=f.Vb({type:X}),X.\u0275inj=f.Ub({factory:function(e){return new(e||X)}}),X),A=((x=function e(){a(this,e)}).\u0275mod=f.Vb({type:x}),x.\u0275inj=f.Ub({factory:function(e){return new(e||x)},imports:[[r.c,b.g,m.u,E.a,m.H,V.a,m.k,m.F,m.p,m.sb,m.R,m.gb,q,y.e,p.g.forChild([{path:"",component:_},{path:"domain",loadChildren:function(){return n.e(20).then(n.bind(null,"uIsd")).then((function(e){return e.DomainModule}))}}])]]}),x)},Vvdx:function(n,c,r){"use strict";r.d(c,"a",(function(){return d}));var o=r("i/XZ"),l=r("AytR"),u=r("fXoL"),s=r("tk/3"),d=function(){var n=function(n){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)}(r,n);var c=t(r);function r(e){return a(this,r),c.call(this,{apiUrl:l.a.apiUrl,entity:"sys/coded-domain"},e)}return i(r,[{key:"getManyCodedValues",value:function(e){return this.http.get(this.getBaseUrl()+"/".concat(e,"/coded-values"))}},{key:"insertCodedValue",value:function(e,t){return this.http.post(this.getBaseUrl()+"/".concat(e,"/coded-values"),JSON.stringify(t),{headers:{"Content-type":"application/json"}})}},{key:"deleteCodedValue",value:function(e,t){return this.http.delete(this.getBaseUrl()+"/".concat(e,"/coded-values/").concat(t))}}]),r}(o.a);return n.\u0275fac=function(e){return new(e||n)(u.hc(s.b))},n.\u0275prov=u.Tb({token:n,factory:n.\u0275fac,providedIn:"root"}),n}()}}])}();
(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{U3uG:function(e,t,c){"use strict";c.r(t),c.d(t,"RoleModule",(function(){return Q}));var i=c("ofXK"),n=c("mrSG"),l=c("dihp"),o=c("advQ"),a=c("ExIg"),s=c("cp0P"),r=c("nYR2"),d=c("fXoL"),u=c("tyNb"),h=c("aceb"),g=c("3Pt+"),m=c("NL+w"),b=c("wnGv"),f=c("GwA9");const p=["table"],v=["tplCellStatus"],y=["tplCellSum"],E=["tplCellRoleParent"];function C(e,t){if(1&e){const e=d.ec();d.dc(0,"div"),d.dc(1,"nb-card"),d.dc(2,"nb-card-header"),d.Oc(3,"Ch\u1ec9nh s\u1eeda"),d.cc(),d.dc(4,"nb-card-body"),d.dc(5,"div",0),d.dc(6,"div",18),d.dc(7,"label",4),d.dc(8,"strong"),d.Oc(9,"Nh\xf3m quy\u1ec1n"),d.cc(),d.cc(),d.dc(10,"ga-tree",5,6),d.kc("itemSelectedChange",(function(t){return d.Dc(e),d.mc().mulEditEntity.roleParent=t})),d.cc(),d.cc(),d.dc(12,"div",19),d.dc(13,"nb-radio-group",20),d.kc("ngModelChange",(function(t){return d.Dc(e),d.mc().mulEditEntity.status=t})),d.dc(14,"nb-radio",21),d.dc(15,"nb-alert",22),d.Oc(16," M\u1edf "),d.cc(),d.cc(),d.dc(17,"nb-radio",21),d.dc(18,"nb-alert",23),d.Oc(19," Kh\xf3a "),d.cc(),d.cc(),d.dc(20,"nb-radio",21),d.dc(21,"nb-alert",24),d.Oc(22," \u1ea8n "),d.cc(),d.cc(),d.cc(),d.cc(),d.cc(),d.cc(),d.dc(23,"nb-card-footer",25),d.dc(24,"button",26),d.kc("click",(function(){return d.Dc(e),d.mc().cancelMulEdit()})),d.Oc(25," H\u1ee7y "),d.cc(),d.dc(26,"button",27),d.kc("click",(function(){return d.Dc(e),d.mc().mulEditSubmit()})),d.Oc(27," C\u1eadp nh\u1eadt "),d.cc(),d.cc(),d.cc(),d.cc()}if(2&e){const e=d.mc();d.Lb(10),d.sc("displayRefresh",!0)("config",e.treeConfig)("itemSelected",e.mulEditEntity.roleParent),d.Lb(3),d.sc("ngModel",e.mulEditEntity.status),d.Lb(1),d.sc("value",e.RoleStatusEnum.Open),d.Lb(3),d.sc("value",e.RoleStatusEnum.Lock),d.Lb(3),d.sc("value",e.RoleStatusEnum.Hide),d.Lb(6),d.sc("disabled",e.isMulEditingReq)("nbSpinner",e.isMulEditingReq)}}function S(e,t){if(1&e&&(d.dc(0,"nb-alert",30),d.Oc(1),d.cc()),2&e){const e=d.mc().value,t=d.mc();d.sc("status",e===t.RoleStatusEnum.Hide?"default":e===t.RoleStatusEnum.Lock?"danger":e===t.RoleStatusEnum.Open?"success":""),d.Lb(1),d.Qc(" ",e===t.RoleStatusEnum.Hide?"\u1ea8n":e===t.RoleStatusEnum.Lock?"Kh\xf3a":e===t.RoleStatusEnum.Open?"M\u1edf":""," ")}}function k(e,t){if(1&e){const e=d.ec();d.dc(0,"nb-select",20),d.kc("ngModelChange",(function(t){d.Dc(e);const c=d.mc();return c.rowEdit[c.column.prop]=t})),d.dc(1,"nb-option",21),d.Oc(2,"M\u1edf"),d.cc(),d.dc(3,"nb-option",21),d.Oc(4,"Kh\xf3a"),d.cc(),d.dc(5,"nb-option",21),d.Oc(6,"\u1ea8n"),d.cc(),d.cc()}if(2&e){const e=d.mc(),t=e.rowEdit,c=e.column,i=d.mc();d.sc("ngModel",t[c.prop]),d.Lb(1),d.sc("value",i.RoleStatusEnum.Open),d.Lb(2),d.sc("value",i.RoleStatusEnum.Lock),d.Lb(2),d.sc("value",i.RoleStatusEnum.Hide)}}function M(e,t){if(1&e&&(d.Mc(0,S,2,2,"nb-alert",28),d.Mc(1,k,7,4,"nb-select",29)),2&e){const e=t.isEdit;d.sc("ngIf",!e),d.Lb(1),d.sc("ngIf",e)}}function I(e,t){1&e&&d.Oc(0),2&e&&d.Qc(" ",t.value.length,"\n")}function w(e,t){if(1&e&&(d.bc(0),d.Oc(1),d.ac()),2&e){const e=d.mc().value;d.Lb(1),d.Qc(" ",e.roleName," ")}}function O(e,t){if(1&e){const e=d.ec();d.bc(0),d.dc(1,"ga-tree",31),d.kc("itemSelectedChange",(function(t){return d.Dc(e),d.mc().rowEdit.roleParent=t})),d.cc(),d.ac()}if(2&e){const e=d.mc(2);d.Lb(1),d.sc("config",e.treeConfig)}}function L(e,t){if(1&e&&(d.Mc(0,w,2,1,"ng-container",12),d.Mc(1,O,2,1,"ng-container",12)),2&e){const e=t.isEdit;d.sc("ngIf",!e),d.Lb(1),d.sc("ngIf",e)}}let R=(()=>{class e{constructor(e,t,c,i){this.roleService=e,this.router=t,this.activatedRoute=c,this.toast=i,this.RoleStatusEnum=o.a,this.ColumnMode=a.a,this.columns=[],this.bulkActions=[{name:"edit",title:"Ch\u1ec9nh s\u1eeda"},{name:"delete",title:"X\xf3a"}],this.actions=[{name:"quick-edit"},{name:"application",icon:'<i class="fab fa-windows"></i>',tooltip:"Xem quy\u1ec1n truy c\u1eadp \xfang d\u1ee5ng",click:e=>this.viewApplication(e)},{name:"layer",icon:'<i class="fas fa-layer-group"></i>',tooltip:"Xem quy\u1ec1n truy c\u1eadp l\u1edbp d\u1eef li\u1ec7u",click:e=>this.viewLayer(e)},{name:"delete"}],this.datatableService={service:this.roleService,primaryField:"roleId",builder:this.getDataServiceBuilder.bind(this)},this.filterSelectConfig={displayValueAll:!0,service:this.roleService,fieldValue:"roleId",fieldName:"roleName",fieldGroup:"roleParentId"},this.entityAdd={},this.isAdding=!1,this.treeConfig={displayValueAll:!0,service:this.roleService,fieldValue:"roleId",fieldName:"roleName",fieldParent:"roleParentId"},this.filterEntity={roleName:"",roleParentId:null},this.tblItemSelected=[],this.mulEditEntity=null,this.isMulEditingReq=!1}ngOnInit(){this.columns=[{name:"T\xean",prop:"roleName",flexGrow:1,type:"string"},{name:"Nh\xf3m",prop:"roleParent",minWidth:270,cellTemplate:this.tplCellRoleParent},{name:"T\xe0i kho\u1ea3n",prop:"users",width:70,cellTemplate:this.tplCellSum},{name:"Tr\u1ea1ng th\xe1i",prop:"status",maxWidth:170,type:"boolean",cellTemplate:this.tplCellStatus}]}getDataServiceBuilder(e){e.select(["roleName","roleParent","users","status"]),e.setJoin([{field:"roleParent",select:["roleName"]},{field:"users",select:["userId"]}]);const{roleName:t,roleParentId:c}=this.filterEntity;c&&e.setFilter({field:"roleParentId",operator:"$eq",value:c}),t&&e.setFilter({field:"roleName",operator:"$cont",value:t})}viewApplication(e){this.router.navigate([e.roleId,"application"],{relativeTo:this.activatedRoute})}viewLayer(e){this.router.navigate([e.roleId,"layer"],{relativeTo:this.activatedRoute})}buttonNewClick(){return Object(n.a)(this,void 0,void 0,(function*(){if(this.entityAdd.roleName)try{this.isAdding=!0,yield this.roleService.create(this.entityAdd).toPromise(),this.toast.success("Th\xeam m\u1edbi th\xe0nh c\xf4ng","Th\xf4ng b\xe1o"),this.table.loadData()}catch(e){this.toast.danger(e&&e.message,"L\u1ed7i")}finally{this.isAdding=!1}else this.toast.warning("Nh\u1eadp t\xean quy\u1ec1n","L\u1ed7i nh\u1eadp li\u1ec7u")}))}filter(){this.table.loadData()}selectedItem(e){this.tblItemSelected=e.selected}bulkClick(e){"delete"===e.action.name||"edit"===e.action.name&&(this.mulEditEntity={})}get isMulEdit(){return Boolean(this.mulEditEntity)}mulEditSubmit(){this.tblItemSelected&&this.mulEditEntity&&(this.isMulEditingReq=!0,this.subcriberMulEdit=Object(s.a)(this.tblItemSelected.map(e=>this.roleService.patch(e.roleId,{roleParent:this.mulEditEntity.roleParent,status:this.mulEditEntity.status}))).pipe(Object(r.a)(()=>{this.isMulEditingReq=!1,delete this.subcriberMulEdit,delete this.mulEditEntity})).subscribe(e=>{this.toast.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng"),this.table.loadData()},e=>{this.toast.danger(e&&e.message,"L\u1ed7i")}))}cancelMulEdit(){this.subcriberMulEdit&&this.subcriberMulEdit.unsubscribe(),delete this.subcriberMulEdit,this.mulEditEntity=null,this.isMulEditingReq=!1}}return e.\u0275fac=function(t){return new(t||e)(d.Xb(l.b),d.Xb(u.c),d.Xb(u.a),d.Xb(h.qb))},e.\u0275cmp=d.Rb({type:e,selectors:[["ga-role"]],viewQuery:function(e,t){var c;1&e&&(d.Jc(p,!0),d.Jc(v,!0),d.Jc(y,!0),d.Jc(E,!0)),2&e&&(d.zc(c=d.lc())&&(t.table=c.first),d.zc(c=d.lc())&&(t.tplCellStatus=c.first),d.zc(c=d.lc())&&(t.tplCellSum=c.first),d.zc(c=d.lc())&&(t.tplCellRoleParent=c.first))},decls:39,vars:19,consts:[[1,"row"],[1,"col-md-12"],[1,"col-md-4"],["nbInput","","fieldSize","small","fullWidth","","placeholder","T\xean quy\u1ec1n",1,"form-input",3,"ngModel","ngModelChange"],["for","",1,"form-input"],["fullWidth","",1,"form-input",3,"displayRefresh","config","itemSelected","itemSelectedChange"],["tree",""],["nbButton","","size","small",3,"disabled","nbSpinner","click"],[1,"col-md-8"],["placeholder","Nh\xf3m quy\u1ec1n",1,"form-input",3,"config","value","valueChange"],["nbInput","","fieldSize","small","type","text","placeholder","T\xean quy\u1ec1n",1,"form-input",3,"ngModel","ngModelChange"],["nbButton","","size","small","outline","","status","primary",1,"form-input",3,"click"],[4,"ngIf"],["selectionType","checkbox",1,"material","striped","mt-2",3,"externalPaging","columns","datatableService","actions","columnMode","limit","bulkActions","rowHeight","selected","select","bulkClick"],["table",""],["tplCellStatus",""],["tplCellSum",""],["tplCellRoleParent",""],[1,"col-md-9","col-xs-12"],[1,"col-md-3","col-xs-12"],[3,"ngModel","ngModelChange"],[3,"value"],["gaTag","","status","success"],["gaTag","","status","danger"],["gaTag","","status","default"],[1,"d-flex","justify-content-between"],["status","danger","nbButton","","size","small","outline","",3,"click"],["nbButton","","size","small","status","primary",3,"disabled","nbSpinner","click"],["gaTag","",3,"status",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["gaTag","",3,"status"],[1,"tree",3,"config","itemSelectedChange"]],template:function(e,t){if(1&e){const e=d.ec();d.dc(0,"div",0),d.dc(1,"div",1),d.dc(2,"nb-card"),d.dc(3,"nb-card-header"),d.Oc(4,"Quy\u1ec1n"),d.cc(),d.dc(5,"nb-card-body"),d.dc(6,"div",0),d.dc(7,"div",2),d.dc(8,"nb-card"),d.dc(9,"nb-card-header"),d.Oc(10,"Th\xeam m\u1edbi"),d.cc(),d.dc(11,"nb-card-body"),d.dc(12,"input",3),d.kc("ngModelChange",(function(e){return t.entityAdd.roleName=e})),d.cc(),d.dc(13,"label",4),d.dc(14,"strong"),d.Oc(15,"Nh\xf3m quy\u1ec1n"),d.cc(),d.cc(),d.dc(16,"ga-tree",5,6),d.kc("itemSelectedChange",(function(e){return t.entityAdd.roleParent=e})),d.cc(),d.cc(),d.dc(18,"nb-card-footer"),d.dc(19,"button",7),d.kc("click",(function(){d.Dc(e);const c=d.Ac(17);return t.buttonNewClick(),c.loadData()})),d.Oc(20," Th\xeam m\u1edbi "),d.cc(),d.cc(),d.cc(),d.cc(),d.dc(21,"div",8),d.dc(22,"div",0),d.dc(23,"div",1),d.dc(24,"div"),d.dc(25,"ga-select",9),d.kc("valueChange",(function(e){return t.filterEntity.roleParentId=e})),d.cc(),d.dc(26,"input",10),d.kc("ngModelChange",(function(e){return t.filterEntity.roleName=e})),d.cc(),d.dc(27,"button",11),d.kc("click",(function(){return t.filter()})),d.Oc(28," L\u1ecdc "),d.cc(),d.Mc(29,C,28,9,"div",12),d.cc(),d.dc(30,"ngn-datatable",13,14),d.kc("select",(function(e){return t.selectedItem(e)}))("bulkClick",(function(e){return t.bulkClick(e)})),d.cc(),d.cc(),d.cc(),d.cc(),d.cc(),d.cc(),d.cc(),d.cc(),d.cc(),d.Mc(32,M,2,2,"ng-template",null,15,d.Nc),d.Mc(34,I,1,1,"ng-template",null,16,d.Nc),d.Mc(36,L,2,2,"ng-template",null,17,d.Nc),d.Yb(38,"router-outlet")}2&e&&(d.Lb(12),d.sc("ngModel",t.entityAdd.roleName),d.Lb(4),d.sc("displayRefresh",!0)("config",t.treeConfig)("itemSelected",t.entityAdd.roleParent),d.Lb(3),d.sc("disabled",t.isMulEdit)("nbSpinner",t.isAdding),d.Lb(6),d.sc("config",t.filterSelectConfig)("value",t.filterEntity.roleParentId),d.Lb(1),d.sc("ngModel",t.filterEntity.roleName),d.Lb(3),d.sc("ngIf",t.isMulEdit),d.Lb(1),d.sc("externalPaging",!0)("columns",t.columns)("datatableService",t.datatableService)("actions",t.actions)("columnMode",t.ColumnMode.force)("limit",10)("bulkActions",t.bulkActions)("rowHeight","auto")("selected",t.tblItemSelected))},directives:[h.r,h.t,h.q,h.G,g.b,g.j,g.m,m.a,h.s,h.o,h.kb,b.a,i.u,a.d,u.h,h.bb,h.ab,h.j,f.a,h.fb,h.W],styles:[".body[_ngcontent-%COMP%]{width:240px;height:70vh}.tree[_ngcontent-%COMP%]{max-height:240px;overflow:auto}.card-filter[_ngcontent-%COMP%]{max-height:300px}"]}),e})();var P=c("BDdu"),N=c("1ua0"),T=c("ronx"),A=c("6n0X"),x=c("DS98"),q=c("tvm6"),D=c("jF+W"),z=c("EaEm");const X=["dlg"];let B=(()=>{class e{constructor(e,t){this.router=e,this.activatedRoute=t,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1}}ngOnInit(){this.roleId=this.activatedRoute.snapshot.paramMap.get("roleId")}closeViewField(){this.router.navigate(["../.."],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.dlg.close()}}return e.\u0275fac=function(t){return new(t||e)(d.Xb(u.c),d.Xb(u.a))},e.\u0275cmp=d.Rb({type:e,selectors:[["ga-role-dlg-app"]],viewQuery:function(e,t){var c;1&e&&d.Jc(X,!0),2&e&&d.zc(c=d.lc())&&(t.dlg=c.first)},decls:9,vars:9,consts:[[3,"open","userConfig"],["dlg",""],[3,"roleId"],["nbButton","","size","small","ghost","",3,"click"]],template:function(e,t){1&e&&(d.dc(0,"core-dialog",0,1),d.dc(2,"core-dialog-header"),d.Oc(3,"\u1ee8ng d\u1ee5ng"),d.cc(),d.dc(4,"core-dialog-body"),d.Yb(5,"ga-application",2),d.cc(),d.dc(6,"core-dialog-footer"),d.dc(7,"button",3),d.kc("click",(function(){return t.closeViewField()})),d.Oc(8,"\u0110\xf3ng"),d.cc(),d.cc(),d.cc()),2&e&&(d.sc("open",!0)("userConfig",t.userConfig),d.Lb(4),d.Kc("width",80,"vw")("max-height",70,"vh")("overflow","auto"),d.Lb(1),d.sc("roleId",t.roleId))},directives:[D.b,D.d,D.a,z.a,D.c,h.o],encapsulation:2}),e})();var J=c("5CSc");const j=["dlg"];let H=(()=>{class e{constructor(e,t){this.router=e,this.route=t,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1}}ngOnInit(){this.roleId=this.route.snapshot.paramMap.get("roleId")}exit(){this.router.navigate(["../.."],{relativeTo:this.route})}ngOnDestroy(){this.dlg.close()}}return e.\u0275fac=function(t){return new(t||e)(d.Xb(u.c),d.Xb(u.a))},e.\u0275cmp=d.Rb({type:e,selectors:[["ga-role-dlg-app"]],viewQuery:function(e,t){var c;1&e&&d.Jc(j,!0),2&e&&d.zc(c=d.lc())&&(t.dlg=c.first)},decls:9,vars:4,consts:[[3,"open","userConfig","width"],["dlg",""],[1,"w-100",3,"roleId"],["nbButton","","size","small","ghost","",3,"click"]],template:function(e,t){if(1&e){const e=d.ec();d.dc(0,"core-dialog",0,1),d.dc(2,"core-dialog-header"),d.Oc(3,"L\u1edbp d\u1eef li\u1ec7u"),d.cc(),d.dc(4,"core-dialog-body"),d.Yb(5,"ga-layer",2),d.cc(),d.dc(6,"core-dialog-footer"),d.dc(7,"button",3),d.kc("click",(function(){return d.Dc(e),d.Ac(1).close(),t.exit()})),d.Oc(8,"\u0110\xf3ng"),d.cc(),d.cc(),d.cc()}2&e&&(d.sc("open",!0)("userConfig",t.userConfig)("width","100vw"),d.Lb(5),d.sc("roleId",t.roleId))},directives:[D.b,D.d,D.a,J.a,D.c,h.o],encapsulation:2}),e})(),Q=(()=>{class e{}return e.\u0275mod=d.Vb({type:e}),e.\u0275inj=d.Ub({factory:function(t){return new(t||e)},imports:[[i.c,h.f,h.B,h.u,h.H,h.k,h.p,N.a,g.g,h.gb,A.a,h.lb,P.a,h.w,T.a,x.a,h.cb,q.a,a.e,u.g.forChild([{path:"",component:R,children:[{path:":roleId/application",component:B},{path:":roleId/layer",component:H}]}])]]}),e})()}}]);
!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var c=Object.prototype.toString.call(e).slice(8,-1);"Object"===c&&e.constructor&&(c=e.constructor.name);if("Map"===c||"Set"===c)return Array.from(e);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,c=new Array(t);n<t;n++)c[n]=e[n];return c}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{uIsd:function(t,i,o){"use strict";o.r(i),o.d(i,"DomainModule",(function(){return V}));var d=o("ofXK"),a=o("Vvdx"),r=o("nYR2"),l=o("fXoL"),u=o("aceb"),s=o("tyNb"),f=o("3Pt+"),h=o("ExIg");function b(e,t){if(1&e){var n=l.ec();l.dc(0,"input",8),l.kc("ngModelChange",(function(e){return l.Dc(n),t.row.name=e}))("change",(function(){l.Dc(n);var e=t.row;return l.mc().updateName(e)})),l.cc()}2&e&&l.sc("ngModel",t.row.name)}function m(e,t){if(1&e){var n=l.ec();l.dc(0,"input",19),l.kc("ngModelChange",(function(e){return l.Dc(n),t.row.code=e})),l.cc()}if(2&e){var c=t.row,i=l.mc(2);l.sc("ngModel",c.code)("type",i.getCodeType())}}function g(e,t){if(1&e){var n=l.ec();l.dc(0,"input",20),l.kc("ngModelChange",(function(e){return l.Dc(n),t.row.name=e})),l.cc()}2&e&&l.sc("ngModel",t.row.name)}function p(e,t){if(1&e){var n=l.ec();l.dc(0,"button",21),l.kc("click",(function(){l.Dc(n);var e=t.row;return l.mc(2).deleteCodeValue(e)})),l.Yb(1,"nb-icon",22),l.cc()}}function y(e,t){if(1&e){var n=l.ec();l.dc(0,"nb-card-body"),l.dc(1,"div",9),l.dc(2,"input",10),l.kc("ngModelChange",(function(e){return l.Dc(n),l.mc().entityCodedValueAdd.code=e})),l.cc(),l.dc(3,"input",11),l.kc("ngModelChange",(function(e){return l.Dc(n),l.mc().entityCodedValueAdd.name=e})),l.cc(),l.dc(4,"button",12),l.kc("click",(function(){return l.Dc(n),l.mc().addCodedValue()})),l.Yb(5,"nb-icon",13),l.cc(),l.cc(),l.dc(6,"ngn-datatable",14),l.dc(7,"ngn-datatable-column",15),l.Mc(8,m,1,2,"ng-template",16),l.cc(),l.dc(9,"ngn-datatable-column",17),l.Mc(10,g,1,1,"ng-template",6),l.cc(),l.dc(11,"ngn-datatable-column",18),l.Mc(12,p,2,0,"ng-template",6),l.cc(),l.cc(),l.cc()}if(2&e){var c=l.mc();l.Lb(2),l.sc("type",c.getCodeType())("ngModel",c.entityCodedValueAdd.code),l.Lb(1),l.sc("ngModel",c.entityCodedValueAdd.name),l.Lb(1),l.sc("nbSpinner",c.isAddCodedValue)("disabled",c.isAddCodedValue),l.Lb(2),l.sc("rows",c.codedValues),l.Lb(1),l.sc("flexGrow",1),l.Lb(2),l.sc("flexGrow",2),l.Lb(2),l.sc("width",20)}}var w,v,C=function(e){return[e]},M=function(){return[]},S=((v=function(){function t(e,c,i,o,d){n(this,t),this.service=e,this.toast=c,this.router=i,this.route=o,this.domainService=d,this.rows=[],this.tmpRows=[],this.codedValues=[],this.entityCodedValueAdd={},this.isAddCodedValue=!1,this.datatableSeriveDomain={service:this.domainService,primaryField:"id",builder:this.getBuilderDomain.bind(this)}}var i,o,d;return i=t,(o=[{key:"ngOnInit",value:function(){var t=this;this.service.getMany().subscribe((function(n){t.rows=n,t.tmpRows=e(n),t.route.queryParamMap.subscribe((function(e){var n=e.get("fname");t._fName=n,t.filterDomain(n)}))}))}},{key:"filterDomain",value:function(e){if(e){var t=e.toLowerCase(),n=this.tmpRows.filter((function(e){return e.id.toLowerCase().search(t)>-1}));this.rows=n}}},{key:"updateName",value:function(e){this.service.patch(e.id,{name:e.name}).subscribe()}},{key:"selectRow",value:function(e){if(e.length){this.codedValues=[];var t=e[0];this.rowSelected=t,t.id&&this.loadCodedValues(t)}}},{key:"loadCodedValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rowSelected;this.service.getManyCodedValues(t.id).subscribe((function(t){return e.codedValues=t}))}},{key:"getCodeType",value:function(){if(!this.rowSelected||!this.rowSelected.type)return"string";var e=this.rowSelected.type;return"esriFieldTypeInteger"===e||"esriFieldTypeSmallInteger"===e?"number":"esriFieldTypeString"===e?"string":void 0}},{key:"addCodedValue",value:function(){var e=this;this.rowSelected&&this.rowSelected.id&&this.entityCodedValueAdd&&this.entityCodedValueAdd.code&&this.entityCodedValueAdd.name&&(this.isAddCodedValue=!0,this.service.insertCodedValue(this.rowSelected.id,this.entityCodedValueAdd).pipe(Object(r.a)((function(){return e.isAddCodedValue=!1}))).subscribe((function(){e.toast.success("Th\xeam th\xe0nh c\xf4ng","Th\xf4ng b\xe1o"),e.loadCodedValues()}),(function(t){return e.toast.danger(t,"L\u1ed7i")})))}},{key:"deleteCodeValue",value:function(e){var t=this;this.rowSelected&&this.rowSelected.id&&e.code&&this.service.deleteCodedValue(this.rowSelected.id,e.code).subscribe((function(){t.toast.success("X\xf3a th\xe0nh c\xf4ng","Th\xf4ng b\xe1o"),t.loadCodedValues()}))}},{key:"getBuilderDomain",value:function(e){e.select(["name","type","codedValues"]),e.setJoin([{field:"codedValues",select:["code","domain","name"]}])}},{key:"fName",get:function(){return this._fName},set:function(e){var t={};e&&(t.fname=e),this.router.navigate([],{relativeTo:this.route,queryParams:t})}}])&&c(i.prototype,o),d&&c(i,d),t}()).\u0275fac=function(e){return new(e||v)(l.Xb(a.a),l.Xb(u.qb),l.Xb(s.c),l.Xb(s.a),l.Xb(a.a))},v.\u0275cmp=l.Rb({type:v,selectors:[["ga-domain"]],decls:14,vars:9,consts:[[1,"row"],[1,"col-md-6"],["nbInput","","fieldSize","small","fullWidth","","placeholder","T\xecm ki\u1ebfm",3,"ngModel","ngModelChange"],["rowHeight","60","headerHeight","60","footerHeight","60","selectionType","single",1,"material","striped","mt-2",3,"limit","selected","datatableService","scrollbarV","select"],["width","250","name","T\xean","prop","id"],["width","250","name","M\xf4 t\u1ea3","prop","name"],["ngn-datatable-cell-template",""],[4,"ngIf"],["nbInput","","fieldSize","small","type","text","fullWidth","","placeholder","Nh\u1eadp m\xf4 t\u1ea3",3,"ngModel","ngModelChange","change"],[1,"d-flex"],["nbInput","","fieldSize","small","fullWidth","","placeholder","Nh\u1eadp gi\xe1 tr\u1ecb",1,"flex-grow-1",3,"type","ngModel","ngModelChange"],["nbInput","","fieldSize","small","fullWidth","","placeholder","M\xf4 t\u1ea3",1,"flex-grow-1","ml-2",3,"ngModel","ngModelChange"],["nbButton","","size","small","ghost","","nbTooltip","Th\xeam m\u1edbi",3,"nbSpinner","disabled","click"],["icon","plus-outline"],["rowHeight","60","headerHeight","60","columnMode","force","footerHeight","60",1,"material","striped","mt-2",3,"rows"],["name","Gi\xe1 tr\u1ecb","prop","code",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","M\xf4 t\u1ea3","prop","name",3,"flexGrow"],["name","",3,"width"],["nbInput","","fieldSize","small","fullWidth","",3,"ngModel","type","ngModelChange"],["nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange"],["nbButton","","size","small","ghost","","nbTooltip","X\xf3a","status","danger",3,"click"],["icon","trash-outline"]],template:function(e,t){1&e&&(l.dc(0,"div",0),l.dc(1,"nb-card",1),l.dc(2,"nb-card-header"),l.Oc(3,"Danh m\u1ee5c domain"),l.cc(),l.dc(4,"nb-card-body"),l.dc(5,"input",2),l.kc("ngModelChange",(function(e){return t.fName=e})),l.cc(),l.dc(6,"ngn-datatable",3),l.kc("select",(function(e){return t.selectRow(e.selected)})),l.Yb(7,"ngn-datatable-column",4),l.dc(8,"ngn-datatable-column",5),l.Mc(9,b,1,1,"ng-template",6),l.cc(),l.cc(),l.cc(),l.cc(),l.dc(10,"nb-card",1),l.dc(11,"nb-card-header"),l.Oc(12,"Mi\u1ec1n gi\xe1 tr\u1ecb"),l.cc(),l.Mc(13,y,13,9,"nb-card-body",7),l.cc(),l.cc()),2&e&&(l.Lb(5),l.sc("ngModel",t.fName),l.Lb(1),l.sc("limit",10)("selected",t.rowSelected?l.vc(6,C,t.rowSelected):l.uc(8,M))("datatableService",t.datatableSeriveDomain)("scrollbarV",!1),l.Lb(7),l.sc("ngIf",t.rowSelected))},directives:[u.r,u.t,u.q,u.G,f.b,f.j,f.m,h.d,h.c,h.b,d.u,u.o,u.rb,u.kb,u.D],styles:[""]}),v),V=((w=function e(){n(this,e)}).\u0275mod=l.Vb({type:w}),w.\u0275inj=l.Ub({factory:function(e){return new(e||w)},imports:[[d.c,f.g,u.H,u.u,u.p,u.F,u.sb,u.lb,h.e,s.g.forChild([{path:"",component:S}])],s.g]}),w)}}])}();
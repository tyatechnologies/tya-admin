(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+C6U":function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return D})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return y}));var i=n("fXoL"),a=n("ofXK");const r=["move","copy","link"];function l(e){return"application/x-dnd"===e.substr(0,"application/x-dnd".length)}function d(e){if(e.dataTransfer){const t=e.dataTransfer.types;if(!t)return"Text";for(let e=0;e<t.length;e++)if("Text"===t[e]||"application/json"===t[e]||l(t[e]))return t[e]}return null}function s(e,t){return"all"===t||"uninitialized"===t?e:e.filter((function(e){return-1!==t.toLowerCase().indexOf(e)}))}function c(e,t){const n=window.getComputedStyle(t),i=parseFloat(n.paddingTop)||0,a=parseFloat(n.paddingLeft)||0,r=parseFloat(n.borderTopWidth)||0,l=parseFloat(n.borderLeftWidth)||0;return{x:e.offsetX+a+l,y:e.offsetY+i+r}}const o={isDragging:!1,dropEffect:"none",effectAllowed:"all",type:void 0};function u(){o.isDragging=!1,o.dropEffect=void 0,o.effectAllowed=void 0,o.type=void 0}function h(e,t){!0===o.isDragging&&(o.dropEffect=t),e.dataTransfer.dropEffect=t}function p(e,t){let n=s(r,e.dataTransfer?e.dataTransfer.effectAllowed:"uninitialized");return!0===o.isDragging&&(n=s(n,o.effectAllowed)),t&&(n=s(n,t)),0===n.length?"none":e.ctrlKey&&-1!==n.indexOf("copy")?"copy":e.altKey&&-1!==n.indexOf("link")?"link":n[0]}function g(e){if(!0===o.isDragging)return o.type;const t=d(e);return null!==t&&"Text"!==t&&"application/json"!==t&&t.substr("application/x-dnd".length+1)||void 0}function f(){return!1===o.isDragging}const m=o;let b=(()=>{class e{constructor(e,t,n){this.elementRef=e,this.renderer=t,this.ngZone=n,this.dndEffectAllowed="copy",this.dndDraggingClass="dndDragging",this.dndDraggingSourceClass="dndDraggingSource",this.dndDraggableDisabledClass="dndDraggableDisabled",this.dndDragImageOffsetFunction=c,this.dndStart=new i.r,this.dndDrag=new i.r,this.dndEnd=new i.r,this.dndMoved=new i.r,this.dndCopied=new i.r,this.dndLinked=new i.r,this.dndCanceled=new i.r,this.draggable=!0,this.isDragStarted=!1,this.dragEventHandler=e=>this.onDrag(e)}set dndDisableIf(e){this.draggable=!e,this.draggable?this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass):this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass)}set dndDisableDragIf(e){this.dndDisableIf=e}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("drag",this.dragEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("drag",this.dragEventHandler),!0===this.isDragStarted&&u()}onDragStart(e){if(!1===this.draggable)return!1;if(void 0!==this.dndHandle&&void 0===e._dndUsingHandle)return!1;!function(e,t,n){o.isDragging=!0,o.dropEffect="none",o.effectAllowed=t,o.type=n,e.dataTransfer.effectAllowed=t}(e,this.dndEffectAllowed,this.dndType),this.isDragStarted=!0,function(e,t,n){const i="application/x-dnd"+(t.type?"-"+t.type:""),a=JSON.stringify(t);try{e.dataTransfer.setData(i,a)}catch(l){try{e.dataTransfer.setData("application/json",a)}catch(l){const t=s(r,n);e.dataTransfer.effectAllowed=t[0],e.dataTransfer.setData("Text",a)}}}(e,{data:this.dndDraggable,type:this.dndType},m.effectAllowed),this.dragImage=this.determineDragImage(),this.renderer.addClass(this.dragImage,this.dndDraggingClass),void 0===this.dndDragImageElementRef&&void 0===e._dndUsingHandle||function(e,t,n){const i=n(e,t)||{x:0,y:0};e.dataTransfer.setDragImage(t,i.x,i.y)}(e,this.dragImage,this.dndDragImageOffsetFunction);const t=this.renderer.listen(this.elementRef.nativeElement,"drag",()=>{this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggingSourceClass),t()});this.dndStart.emit(e),e.stopPropagation()}onDrag(e){this.dndDrag.emit(e)}onDragEnd(e){let t;switch(m.dropEffect){case"copy":t=this.dndCopied;break;case"link":t=this.dndLinked;break;case"move":t=this.dndMoved;break;default:t=this.dndCanceled}t.emit(e),this.dndEnd.emit(e),u(),this.isDragStarted=!1,this.renderer.removeClass(this.dragImage,this.dndDraggingClass),window.setTimeout(()=>{this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggingSourceClass)},0),e.stopPropagation()}registerDragHandle(e){this.dndHandle=e}registerDragImage(e){this.dndDragImageElementRef=e}determineDragImage(){return void 0!==this.dndDragImageElementRef?this.dndDragImageElementRef.nativeElement:this.elementRef.nativeElement}}return e.\u0275fac=function(t){return new(t||e)(i.Xb(i.o),i.Xb(i.N),i.Xb(i.H))},e.\u0275dir=i.Sb({type:e,selectors:[["","dndDraggable",""]],hostVars:1,hostBindings:function(e,t){1&e&&i.kc("dragstart",(function(e){return t.onDragStart(e)}))("dragend",(function(e){return t.onDragEnd(e)})),2&e&&i.Mb("draggable",t.draggable)},inputs:{dndEffectAllowed:"dndEffectAllowed",dndDraggingClass:"dndDraggingClass",dndDraggingSourceClass:"dndDraggingSourceClass",dndDraggableDisabledClass:"dndDraggableDisabledClass",dndDragImageOffsetFunction:"dndDragImageOffsetFunction",dndDisableIf:"dndDisableIf",dndDisableDragIf:"dndDisableDragIf",dndDraggable:"dndDraggable",dndType:"dndType"},outputs:{dndStart:"dndStart",dndDrag:"dndDrag",dndEnd:"dndEnd",dndMoved:"dndMoved",dndCopied:"dndCopied",dndLinked:"dndLinked",dndCanceled:"dndCanceled"}}),e})(),D=(()=>{class e{constructor(e){this.elementRef=e}}return e.\u0275fac=function(t){return new(t||e)(i.Xb(i.o))},e.\u0275dir=i.Sb({type:e,selectors:[["","dndPlaceholderRef",""]]}),e})(),v=(()=>{class e{constructor(e,t,n){this.ngZone=e,this.elementRef=t,this.renderer=n,this.dndAllowExternal=!1,this.dndHorizontal=!1,this.dndDragoverClass="dndDragover",this.dndDropzoneDisabledClass="dndDropzoneDisabled",this.dndDragover=new i.r,this.dndDrop=new i.r,this.placeholder=null,this.disabled=!1,this.dragEnterEventHandler=e=>this.onDragEnter(e),this.dragOverEventHandler=e=>this.onDragOver(e),this.dragLeaveEventHandler=e=>this.onDragLeave(e)}set dndDisableIf(e){this.disabled=!!e,this.disabled?this.renderer.addClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass):this.renderer.removeClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass)}set dndDisableDropIf(e){this.dndDisableIf=e}ngAfterViewInit(){this.placeholder=this.tryGetPlaceholder(),this.removePlaceholderFromDOM(),this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.addEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.addEventListener("dragleave",this.dragLeaveEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.removeEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.removeEventListener("dragleave",this.dragLeaveEventHandler)}onDragEnter(e){if(!0===e._dndDropzoneActive)return void this.cleanupDragoverState();if(void 0===e._dndDropzoneActive){const t=document.elementFromPoint(e.clientX,e.clientY);this.elementRef.nativeElement.contains(t)&&(e._dndDropzoneActive=!0)}const t=g(e);!1!==this.isDropAllowed(t)&&e.preventDefault()}onDragOver(e){if(e.defaultPrevented)return;const t=g(e);if(!1===this.isDropAllowed(t))return;this.checkAndUpdatePlaceholderPosition(e);const n=p(e,this.dndEffectAllowed);"none"!==n?(e.preventDefault(),h(e,n),this.dndDragover.emit(e),this.renderer.addClass(this.elementRef.nativeElement,this.dndDragoverClass)):this.cleanupDragoverState()}onDrop(e){try{const t=g(e);if(!1===this.isDropAllowed(t))return;const n=function(e,t){const n=d(e);return!0===t?null!==n&&l(n)?JSON.parse(e.dataTransfer.getData(n)):{}:JSON.parse(e.dataTransfer.getData(n))}(e,f());if(!1===this.isDropAllowed(n.type))return;e.preventDefault();const i=p(e);if(h(e,i),"none"===i)return;const a=this.getPlaceholderIndex();if(-1===a)return;this.dndDrop.emit({event:e,dropEffect:i,isExternal:f(),data:n.data,index:a,type:t}),e.stopPropagation()}finally{this.cleanupDragoverState()}}onDragLeave(e){if(void 0===e._dndDropzoneActive){const t=document.elementFromPoint(e.clientX,e.clientY);if(this.elementRef.nativeElement.contains(t))return void(e._dndDropzoneActive=!0)}this.cleanupDragoverState(),h(e,"none")}isDropAllowed(e){if(!0===this.disabled)return!1;if(!0===f()&&!1===this.dndAllowExternal)return!1;if(!this.dndDropzone)return!0;if(!e)return!0;if(!1===Array.isArray(this.dndDropzone))throw new Error("dndDropzone: bound value to [dndDropzone] must be an array!");return-1!==this.dndDropzone.indexOf(e)}tryGetPlaceholder(){return void 0!==this.dndPlaceholderRef?this.dndPlaceholderRef.elementRef.nativeElement:this.elementRef.nativeElement.querySelector("[dndPlaceholderRef]")}removePlaceholderFromDOM(){null!==this.placeholder&&null!==this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}checkAndUpdatePlaceholderPosition(e){if(null===this.placeholder)return;this.placeholder.parentNode!==this.elementRef.nativeElement&&this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder);const t=function(e,t){let n=t;for(;n.parentNode!==e;){if(!n.parentNode)return null;n=n.parentNode}return n}(this.elementRef.nativeElement,e.target);null!==t&&t!==this.placeholder&&(function(e,t,n){const i=t.getBoundingClientRect();return n?e.clientX<i.left+i.width/2:e.clientY<i.top+i.height/2}(e,t,this.dndHorizontal)?t.previousSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,t):t.nextSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,t.nextSibling))}getPlaceholderIndex(){if(null!==this.placeholder)return Array.prototype.indexOf.call(this.elementRef.nativeElement.children,this.placeholder)}cleanupDragoverState(){this.renderer.removeClass(this.elementRef.nativeElement,this.dndDragoverClass),this.removePlaceholderFromDOM()}}return e.\u0275fac=function(t){return new(t||e)(i.Xb(i.H),i.Xb(i.o),i.Xb(i.N))},e.\u0275dir=i.Sb({type:e,selectors:[["","dndDropzone",""]],contentQueries:function(e,t,n){var a;1&e&&i.Qb(n,D,!0),2&e&&i.zc(a=i.lc())&&(t.dndPlaceholderRef=a.first)},hostBindings:function(e,t){1&e&&i.kc("drop",(function(e){return t.onDrop(e)}))},inputs:{dndAllowExternal:"dndAllowExternal",dndHorizontal:"dndHorizontal",dndDragoverClass:"dndDragoverClass",dndDropzoneDisabledClass:"dndDropzoneDisabledClass",dndDisableIf:"dndDisableIf",dndDisableDropIf:"dndDisableDropIf",dndDropzone:"dndDropzone",dndEffectAllowed:"dndEffectAllowed"},outputs:{dndDragover:"dndDragover",dndDrop:"dndDrop"}}),e})(),y=(()=>{class e{}return e.\u0275mod=i.Vb({type:e}),e.\u0275inj=i.Ub({factory:function(t){return new(t||e)},imports:[[a.c]]}),e})()},"5CSc":function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var i=n("ExIg"),a=n("bANk"),r=n("cp0P"),l=n("dihp"),d=n("nYR2"),s=n("CjdU"),c=n("fXoL"),o=n("aceb"),u=n("wnGv"),h=n("ofXK"),p=n("3Pt+");const g=["table"];function f(e,t){if(1&e){const e=c.ec();c.dc(0,"div"),c.dc(1,"nb-card",23),c.dc(2,"nb-card-header"),c.Oc(3,"Ch\u1ec9nh s\u1eeda"),c.cc(),c.dc(4,"nb-card-body"),c.dc(5,"div",24),c.dc(6,"nb-checkbox",25),c.kc("ngModelChange",(function(t){return c.Dc(e),c.mc().mulEditEntity.isView=t})),c.Oc(7,"\u0110\u01b0\u1ee3c ph\xe9p xem"),c.cc(),c.dc(8,"nb-checkbox",25),c.kc("ngModelChange",(function(t){return c.Dc(e),c.mc().mulEditEntity.isCreate=t})),c.Oc(9,"\u0110\u01b0\u1ee3c ph\xe9p t\u1ea1o"),c.cc(),c.dc(10,"nb-checkbox",25),c.kc("ngModelChange",(function(t){return c.Dc(e),c.mc().mulEditEntity.isEdit=t})),c.Oc(11,"\u0110\u01b0\u1ee3c ph\xe9p ch\u1ec9nh s\u1eeda"),c.cc(),c.dc(12,"nb-checkbox",25),c.kc("ngModelChange",(function(t){return c.Dc(e),c.mc().mulEditEntity.isDelete=t})),c.Oc(13,"\u0110\u01b0\u1ee3c ph\xe9p x\xf3a"),c.cc(),c.cc(),c.dc(14,"div",24),c.dc(15,"input",26),c.kc("ngModelChange",(function(t){return c.Dc(e),c.mc().mulEditEntity.definition=t})),c.cc(),c.cc(),c.cc(),c.dc(16,"nb-card-footer",27),c.dc(17,"button",28),c.kc("click",(function(){return c.Dc(e),c.mc().cancelMulEdit()})),c.Oc(18,"H\u1ee7y"),c.cc(),c.dc(19,"button",29),c.kc("click",(function(){return c.Dc(e),c.mc().mulEditSubmit()})),c.Oc(20,"L\u01b0u"),c.cc(),c.cc(),c.cc(),c.cc()}if(2&e){const e=c.mc();c.Lb(6),c.sc("ngModel",e.mulEditEntity.isView),c.Lb(2),c.sc("ngModel",e.mulEditEntity.isCreate),c.Lb(2),c.sc("ngModel",e.mulEditEntity.isEdit),c.Lb(2),c.sc("ngModel",e.mulEditEntity.isDelete),c.Lb(3),c.sc("ngModel",e.mulEditEntity.definition)}}function m(e,t){if(1&e){const e=c.ec();c.dc(0,"input",30),c.kc("ngModelChange",(function(n){return c.Dc(e),t.row[t.column.prop]=n}))("change",(function(){c.Dc(e);const n=t.column,i=t.row;return c.mc().updateCellValue(n.prop,i)})),c.cc()}2&e&&c.sc("ngModel",t.row[t.column.prop])}function b(e,t){if(1&e){const e=c.ec();c.dc(0,"input",30),c.kc("ngModelChange",(function(n){return c.Dc(e),t.row[t.column.prop]=n}))("change",(function(){c.Dc(e);const n=t.column,i=t.row;return c.mc().updateCellValue(n.prop,i)})),c.cc()}2&e&&c.sc("ngModel",t.row[t.column.prop])}function D(e,t){if(1&e){const e=c.ec();c.dc(0,"input",30),c.kc("ngModelChange",(function(n){return c.Dc(e),t.row[t.column.prop]=n}))("change",(function(){c.Dc(e);const n=t.column,i=t.row;return c.mc().updateCellValue(n.prop,i)})),c.cc()}2&e&&c.sc("ngModel",t.row[t.column.prop])}function v(e,t){if(1&e){const e=c.ec();c.dc(0,"input",30),c.kc("ngModelChange",(function(n){return c.Dc(e),t.row[t.column.prop]=n}))("change",(function(){c.Dc(e);const n=t.column,i=t.row;return c.mc().updateCellValue(n.prop,i)})),c.cc()}2&e&&c.sc("ngModel",t.row[t.column.prop])}function y(e,t){if(1&e){const e=c.ec();c.dc(0,"nb-checkbox",31),c.kc("ngModelChange",(function(n){return c.Dc(e),t.row[t.column.prop]=n}))("ngModelChange",(function(){c.Dc(e);const n=t.column,i=t.row;return c.mc().updateCellValue(n.prop,i)})),c.cc()}2&e&&c.sc("ngModel",t.row[t.column.prop])}let E=(()=>{class e{constructor(e,t,n,a,r){this.layerService=e,this.datasetService=t,this.roleLayerService=n,this.toast=a,this.roleService=r,this.ColumnMode=i.a,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1,hasScroll:!0},this.lstDatasetId=[],this.configSelDts={service:this.datasetService,fieldName:"datasetName",fieldValue:"datasetId"},this.bulks=[{name:"edit",title:"Ch\u1ec9nh s\u1eeda"}],this.isSync=!1,this.tblItemSelected=[],this.mulEditEntity=null,this.isMulEditingReq=!1}ngOnInit(){this.datatableService={service:this.roleLayerService,primaryField:"id",builder:this.getBuilder.bind(this)}}getBuilder(e){e.select(["roleId","isView","isCreate","isDelete","isEdit","definition","outFields","queryFields","updateFields"]),e.setJoin([{field:"layer",select:["layerName","datasetId"]}]),e.setFilter([{field:"roleId",operator:"$eq",value:this.roleId},{field:"layer.datasetId",operator:"$in",value:this.lstDatasetId}])}selectedItem(e){this.tblItemSelected=e.selected}bulkClick(e){"delete"===e.action.name||"edit"===e.action.name&&(this.mulEditEntity={isEdit:!0,isCreate:!0,isDelete:!0,isView:!0,outFields:null,queryFields:null,updateFields:null})}get isMulEdit(){return Boolean(this.mulEditEntity)}mulEditSubmit(){this.tblItemSelected&&this.mulEditEntity&&(this.isMulEditingReq=!0,this.subcriberMulEdit=Object(r.a)(this.tblItemSelected.map(e=>this.roleLayerService.patch(e.id,this.mulEditEntity))).pipe(Object(d.a)(()=>{this.isMulEditingReq=!1,delete this.subcriberMulEdit,delete this.mulEditEntity})).subscribe(e=>{this.toast.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng"),this.table.loadData()},e=>{this.toast.danger(e&&e.message,"L\u1ed7i")}))}cancelMulEdit(){this.subcriberMulEdit&&this.subcriberMulEdit.unsubscribe(),delete this.subcriberMulEdit,this.mulEditEntity=null,this.isMulEditingReq=!1}sync(){this.roleId&&(this.lstDatasetId?(this.isSync=!0,this.roleService.syncLayers({roleId:this.roleId,lstDatasetId:this.lstDatasetId}).pipe(Object(d.a)(()=>this.isSync=!1)).subscribe(e=>{this.toast.success("\u0110\u1ed3ng b\u1ed9 th\xe0nh c\xf4ng "+e.length,"Th\xe0nh c\xf4ng"),this.table.loadData()},e=>this.toast.danger(e||"C\xf3 l\u1ed7i x\u1ea3y ra"))):this.toast.warning("Vui l\xf2ng ch\u1ecdn dataset","Th\xf4ng b\xe1o"))}updateCellValue(e,t){this.roleLayerService.patch(t.id,{[e]:t[e]}).subscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Xb(a.a),c.Xb(s.a),c.Xb(l.a),c.Xb(o.qb),c.Xb(l.b))},e.\u0275cmp=c.Rb({type:e,selectors:[["ga-layer"]],viewQuery:function(e,t){var n;1&e&&c.Sc(g,!0),2&e&&c.zc(n=c.lc())&&(t.table=n.first)},inputs:{roleId:"roleId"},decls:33,vars:25,consts:[[1,"row"],[1,"col-md-12"],["fullWidth","","placeholder","Dataset",1,"w-100",3,"multiple","config","value","valueChange"],["selectDts",""],[1,"col-md-12","d-flex","justify-content-end","mt-2"],["nbButton","","size","small","outline","","ghost","","status","danger",3,"click"],["nbButton","","size","small","outline","","ghost","",3,"click"],["nbButton","","size","small","outline","",3,"click"],["nbButton","","outline","","status","danger","nbTooltip","T\u1ea3i l\u1edbp d\u1eef li\u1ec7u t\u1eeb h\u1ec7 th\u1ed1ng \u0111\u1ec3 c\u1ea5p quy\u1ec1n truy c\u1eadp",3,"disabled","nbSpinner","click"],[4,"ngIf"],["selectionType","checkbox",1,"material","striped",3,"externalPaging","limit","datatableService","columnMode","bulkActions","selected","bulkClick","select"],["table",""],["name","T\xean","prop","layer.layerName",3,"flexGrow"],["name","Xem","prop","isView",3,"flexGrow","cellTemplate"],["name","T\u1ea1o","prop","isCreate",3,"flexGrow","cellTemplate"],["name","X\xf3a","prop","isDelete",3,"flexGrow","cellTemplate"],["name","S\u1eeda","prop","isEdit",3,"flexGrow","cellTemplate"],["name","L\u1ec7nh truy v\u1ea5n","prop","definition",3,"flexGrow"],["ngn-datatable-cell-template",""],["name","Thu\u1ed9c t\xednh hi\u1ec3n th\u1ecb","prop","outFields",3,"flexGrow"],["name","Thu\u1ed9c t\xednh t\xecm ki\u1ebfm","prop","queryFields",3,"flexGrow"],["name","Thu\u1ed9c t\xednh c\u1eadp nh\u1eadt","prop","updateFields",3,"flexGrow"],["tplCellStatus",""],[1,"mt-2"],[1,"row","col-md-12"],[1,"form-input",3,"ngModel","ngModelChange"],["type","text","nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["nbButton","","size","small","ghost","",3,"click"],["nbButton","","size","small",3,"click"],["nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange"]],template:function(e,t){if(1&e){const e=c.ec();c.dc(0,"div",0),c.dc(1,"div",1),c.dc(2,"ga-select",2,3),c.kc("valueChange",(function(e){return t.lstDatasetId=e})),c.cc(),c.cc(),c.dc(4,"div",4),c.dc(5,"button",5),c.kc("click",(function(){return t.lstDatasetId=[]})),c.Oc(6,"H\u1ee7y ch\u1ecdn t\u1ea5t c\u1ea3 dataset"),c.cc(),c.dc(7,"button",6),c.kc("click",(function(){return c.Dc(e),c.Ac(3).selectAll()})),c.Oc(8,"Ch\u1ecdn t\u1ea5t c\u1ea3 dataset"),c.cc(),c.dc(9,"button",7),c.kc("click",(function(){return c.Dc(e),c.Ac(17).loadData()})),c.Oc(10,"L\u1ecdc"),c.cc(),c.cc(),c.dc(11,"div",1),c.dc(12,"div"),c.dc(13,"button",8),c.kc("click",(function(){return t.sync()})),c.Oc(14," \u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u "),c.cc(),c.cc(),c.Mc(15,f,21,5,"div",9),c.dc(16,"ngn-datatable",10,11),c.kc("bulkClick",(function(e){return t.bulkClick(e)}))("select",(function(e){return t.selectedItem(e)})),c.Yb(18,"ngn-datatable-column",12),c.Yb(19,"ngn-datatable-column",13),c.Yb(20,"ngn-datatable-column",14),c.Yb(21,"ngn-datatable-column",15),c.Yb(22,"ngn-datatable-column",16),c.dc(23,"ngn-datatable-column",17),c.Mc(24,m,1,1,"ng-template",18),c.cc(),c.dc(25,"ngn-datatable-column",19),c.Mc(26,b,1,1,"ng-template",18),c.cc(),c.dc(27,"ngn-datatable-column",20),c.Mc(28,D,1,1,"ng-template",18),c.cc(),c.dc(29,"ngn-datatable-column",21),c.Mc(30,v,1,1,"ng-template",18),c.cc(),c.cc(),c.cc(),c.cc(),c.Mc(31,y,1,1,"ng-template",null,22,c.Nc)}if(2&e){const e=c.Ac(32);c.Lb(2),c.sc("multiple",!0)("config",t.configSelDts)("value",t.lstDatasetId),c.Lb(11),c.sc("disabled",0===t.lstDatasetId.length||t.isSync)("nbSpinner",t.isSync),c.Lb(2),c.sc("ngIf",t.isMulEdit),c.Lb(1),c.sc("externalPaging",!0)("limit",255)("datatableService",t.datatableService)("columnMode",t.ColumnMode.flex)("bulkActions",t.bulks)("selected",t.tblItemSelected),c.Lb(2),c.sc("flexGrow",2),c.Lb(1),c.sc("flexGrow",1)("cellTemplate",e),c.Lb(1),c.sc("flexGrow",1)("cellTemplate",e),c.Lb(1),c.sc("flexGrow",1)("cellTemplate",e),c.Lb(1),c.sc("flexGrow",1)("cellTemplate",e),c.Lb(1),c.sc("flexGrow",2),c.Lb(2),c.sc("flexGrow",4),c.Lb(2),c.sc("flexGrow",4),c.Lb(2),c.sc("flexGrow",4)}},directives:[u.a,o.o,o.rb,o.kb,h.u,i.d,i.c,i.b,o.r,o.t,o.q,o.v,p.j,p.m,o.G,p.b,o.s],styles:[""]}),e})()},CjdU:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("AytR"),a=n("i/XZ"),r=n("Zt20"),l=n("fXoL"),d=n("tk/3");let s=(()=>{class e extends a.a{constructor(e){super({apiUrl:i.a.apiUrl,entity:"sys/dataset"},e)}getGDBNotExists(){const e=r.a.create({filter:[{field:"notExist",operator:"$eq",value:!0}]});return this.http.get(this.getBaseUrl()+"/gdb",{params:this.getParamsFromQuery(e)})}getManyGDB(){return this.http.get(this.getBaseUrl()+"/gdb")}updateDatasetName(e,t){return this.http.post(this.getBaseUrl()+"/gdb/alias/"+e,{datasetName:t})}updateAliasNameFromGDB(e){return this.http.patch(this.getBaseUrl()+"/aliasfromgdb",{lstDatasetId:e},{headers:{"Content-Type":"application/json"}})}}return e.\u0275fac=function(t){return new(t||e)(l.hc(d.b))},e.\u0275prov=l.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},EaEm:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("mrSG"),a=n("YTAs"),r=n("dihp"),l=n("fXoL"),d=n("aceb"),s=n("+C6U"),c=n("ofXK");function o(e,t){if(1&e&&(l.dc(0,"nb-list-item",5),l.dc(1,"nb-alert",6),l.Oc(2),l.cc(),l.cc()),2&e){const e=t.$implicit;l.sc("dndDraggable",e),l.Lb(1),l.sc("accent","D"===e.environmentId?"success":"W"===e.environmentId?"warning":"M"===e.environmentId?"info":"basic"),l.Lb(1),l.Qc(" ",e.applicationName,"")}}function u(e,t){if(1&e&&(l.dc(0,"nb-list-item",5),l.dc(1,"nb-alert",7),l.Oc(2),l.cc(),l.cc()),2&e){const e=t.$implicit;l.sc("dndDraggable",e),l.Lb(1),l.sc("accent","D"===e.environmentId?"success":"W"===e.environmentId?"warning":"M"===e.environmentId?"info":"basic"),l.Lb(1),l.Qc(" ",e.applicationName,"")}}let h=(()=>{class e{constructor(e,t,n){this.applicationService=e,this.roleService=t,this.toast=n,this.columns=[],this.isRequest=!1}ngOnInit(){this.columns=[{name:"M\xe3 c\u1ed9t",prop:"applicationName"},{name:"T\xean c\u1ed9t",prop:"alias"},{name:"Nh\xf3m",prop:"applicationGroup.applicationName"},{name:"Tr\u1ea1ng th\xe1i",prop:"isEnabled"},{name:"M\xf4i tr\u01b0\u1eddng",prop:"environmentId"}],this.roleService.getOne(this.roleId,{fields:["roleName","applications"],join:[{field:"applications",select:["applicationId","applicationName","environmentId"]}]}).subscribe(e=>{this.lstDataSelected=e.applications;const t=[{field:"isEnabled",operator:"$eq",value:!0}];this.lstDataSelected.length&&t.push({field:"applicationId",operator:"$notin",value:this.lstDataSelected.map(e=>e.applicationId)}),this.applicationService.getMany({fields:["applicationName","applicationGroup","isEnabled","environmentId"],filter:t}).subscribe(e=>this.lstDataAvailable=e)})}onDrop(e,t){return Object(i.a)(this,void 0,void 0,(function*(){const n=e.data,i=[...this.lstDataAvailable],a=[...this.lstDataSelected],r="remove"===t?this.lstDataAvailable:this.lstDataSelected,l="insert"===t?this.lstDataAvailable:this.lstDataSelected,d=l.findIndex(e=>e.applicationId===n.applicationId);if(d>-1){r.push(n),l.splice(d,1);try{this.isRequest=!0,yield this.roleService.patch(this.roleId,{applications:this.lstDataSelected}).toPromise()}catch(s){this.toast.danger(s&&s.message,"L\u1ed7i"),this.lstDataAvailable=i,this.lstDataSelected=a}finally{this.isRequest=!1}}}))}}return e.\u0275fac=function(t){return new(t||e)(l.Xb(a.b),l.Xb(r.b),l.Xb(d.qb))},e.\u0275cmp=l.Rb({type:e,selectors:[["ga-application"]],inputs:{roleId:"roleId"},decls:13,vars:3,consts:[[1,"row",3,"nbSpinner"],[1,"col-md-6"],["dndDropzone","",1,"dndList",3,"dndDrop"],["dndPlaceholderRef","",1,"dndPlaceholder"],[3,"dndDraggable",4,"ngFor","ngForOf"],[3,"dndDraggable"],[1,"full-width",3,"accent"],[3,"accent"]],template:function(e,t){1&e&&(l.dc(0,"div",0),l.dc(1,"div",1),l.dc(2,"nb-card-header"),l.Oc(3,"\u1ee8ng d\u1ee5ng ch\u01b0a ch\u1ecdn"),l.cc(),l.dc(4,"nb-list",2),l.kc("dndDrop",(function(e){return t.onDrop(e,"remove")})),l.Yb(5,"nb-list-item",3),l.Mc(6,o,3,3,"nb-list-item",4),l.cc(),l.cc(),l.dc(7,"div",1),l.dc(8,"nb-card-header"),l.Oc(9,"\u1ee8ng d\u1ee5ng \u0111\xe3 ch\u1ecdn"),l.cc(),l.dc(10,"nb-list",2),l.kc("dndDrop",(function(e){return t.onDrop(e,"insert")})),l.Yb(11,"nb-list-item",3),l.Mc(12,u,3,3,"nb-list-item",4),l.cc(),l.cc(),l.cc()),2&e&&(l.sc("nbSpinner",t.isRequest),l.Lb(6),l.sc("ngForOf",t.lstDataAvailable),l.Lb(6),l.sc("ngForOf",t.lstDataSelected))},directives:[d.kb,d.t,d.P,s.b,d.Q,s.d,c.t,s.a,d.j],styles:["nb-list[_ngcontent-%COMP%]{height:100%}.dndList[_ngcontent-%COMP%]{transition:all .3s ease}.dndList.dndDragover[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:12px}.dndDragging[_ngcontent-%COMP%]{border:1px solid green}.dndPlaceholder[_ngcontent-%COMP%]{min-height:72px;border:1px dashed green;background-color:rgba(0,0,0,.1)}nb-alert[_ngcontent-%COMP%]{margin:0;padding:6px 12px}"]}),e})()},bANk:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("AytR"),a=n("WJ/N"),r=n("fXoL"),l=n("tk/3");let d=(()=>{class e extends a.a{constructor(e){super({apiUrl:i.a.apiUrl,entity:"sys/layer"},e)}getManyGDB(e){return this.http.get(this.getBaseUrl()+"/gdb",{params:this.getParamsFromQuery(e)})}getOneGDB(e){return this.http.get(this.getBaseUrl()+"/gdb/"+e)}updateDatasetName(e,t){return this.http.post(this.getBaseUrl()+"/gdb/alias/"+e,{layerName:t})}getFields(e){return this.http.get(this.getBaseUrl()+`/gdb/${e}/field`)}updateField(e,t,n){return this.http.post(this.getBaseUrl()+`/gdb/${e}/field/${t}`,n)}updateAliasNameFromGDB(e){return this.http.patch(this.getBaseUrl()+"/aliasfromgdb",{lstLayerId:e},{headers:{"Content-Type":"application/json"}})}getColumnType(){return this.http.get(this.getBaseUrl()+"/columndatatype")}getColumns(e){return this.http.get(`${this.getBaseUrl()}/column/${e.table}`)}hasTable(e){return this.http.get(`${this.getBaseUrl()}/hastable/${e.table}`)}createTable(e){return this.http.post(this.getBaseUrl()+"/createtable",JSON.stringify(e.table),{headers:{"content-type":"application/json"}})}addColumn(e){return this.http.post(`${this.getBaseUrl()}/addcolumn/${e.tableName}`,JSON.stringify(e.column),{headers:{"content-type":"application/json"}})}dropColumn(e){return this.http.delete(`${this.getBaseUrl()}/dropColumn/${e.tableName}/${e.columnName}`)}syncColumn(e){return this.http.patch(`${this.getBaseUrl()}/synccolumn/${e.tableName}`,JSON.stringify(e.columns),{headers:{"content-type":"application/json"}})}updateDisplayColumn(e){return this.http.patch(`${this.getBaseUrl()}/columnDisplay/${e.tableName}`,JSON.stringify({columnDisplay:e.columnDisplay}),{headers:{"content-type":"application/json"}})}changeGeometryType(e){return this.http.patch(`${this.getBaseUrl()}/geometrytype/${e.tableName}`,JSON.stringify({geometryType:e.geometryType}),{headers:{"content-type":"application/json"}})}}return e.\u0275fac=function(t){return new(t||e)(r.hc(l.b))},e.\u0275prov=r.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},ronx:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("ofXK"),a=n("1ua0"),r=n("aceb"),l=n("+C6U"),d=n("fXoL");let s=(()=>{class e{}return e.\u0275mod=d.Vb({type:e}),e.\u0275inj=d.Ub({factory:function(t){return new(t||e)},imports:[[i.c,a.a,r.u,r.p,r.R,r.lb,r.k,l.c]]}),e})()},tvm6:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("ofXK"),a=n("1ua0"),r=n("aceb"),l=n("BDdu"),d=n("3Pt+"),s=n("DS98"),c=n("ExIg"),o=n("fXoL");let u=(()=>{class e{}return e.\u0275mod=o.Vb({type:e}),e.\u0275inj=o.Ub({factory:function(t){return new(t||e)},imports:[[i.c,a.a,r.k,l.a,r.w,d.g,s.a,r.H,r.p,r.sb,r.lb,r.u,c.e]]}),e})()}}]);